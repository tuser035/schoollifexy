# 2025년 12월 16일 작업 내용

## 📋 오늘 한 일 요약

1. **상점 부여 시 담임선생님 알림 기능 추가** - 증빙사진 포함
2. **상점/벌점/이달의학생 삭제 시 담임선생님 알림 기능 추가**
3. **삭제 토스트 알림 개선** - 학생 이름 표시 및 2단계 알림
4. **이메일 푸터 텍스트 일괄 변경** - School Point → School Life
5. **교사 대시보드 탭 테마 색상 적용** - 그룹(보라), 일괄발송(분홍), 발송이력(청록)
6. **관리자 대시보드 통계 탭 테마 색상 적용** - 전교생통계(보라), 학급통계(분홍), 학년추이(청록)
7. **관리자 대시보드 데이터 조회 메뉴 테마 적용** - 인디고(남색) 계열
8. **학생 대시보드 상세내역 탭 테마 적용** - 상점(파랑), 벌점(주황), 이달의학생(초록)
9. **교사 대시보드 상점/벌점/이달의학생 탭 테마 적용** - 상점(파랑), 벌점(주황), 이달의학생(초록)

---

## 1. 상점 부여 시 담임선생님 알림 기능

### 🎯 목표
교사가 학생에게 상점을 부여하면, 해당 학생의 담임선생님에게 자동으로 이메일 알림을 보내는 기능

### 📁 수정한 파일들

#### 1-1. Edge Function 수정 (`supabase/functions/notify-homeroom-teacher/index.ts`)

**변경 전:**
```typescript
interface NotifyRequest {
  notificationType: "demerit" | "monthly"; // 알림 유형
  // ... 나머지 필드
}
```

**변경 후:**
```typescript
interface NotifyRequest {
  notificationType: "demerit" | "monthly" | "merit"; // "merit" 추가!
  // ... 나머지 필드
}
```

**상점 알림 이메일 템플릿 추가:**
```typescript
} else if (notificationType === "merit") {
  // 상점 알림
  emailSubject = `⭐ [상점 알림] ${studentGrade}학년 ${studentClass}반 ${studentName} 학생 상점 부여 안내`;
  
  emailHtml = `
    <div style="font-family: 'Apple SD Gothic Neo', 'Malgun Gothic', sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;">
      <div style="background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); padding: 20px; border-radius: 10px 10px 0 0;">
        <h1 style="color: white; margin: 0; font-size: 20px;">⭐ 학생 상점 부여 알림</h1>
      </div>
      <!-- 이하 이메일 본문 -->
    </div>
  `;
}
```

> 💡 **포인트**: 상점 알림은 파란색 그라데이션 배경을 사용해요!

#### 1-2. MeritForm 컴포넌트 수정 (`src/components/teacher/MeritForm.tsx`)

상점 부여 성공 후 담임선생님에게 알림을 보내는 코드 추가:

```typescript
// 상점 부여 성공 후
toast.success(`${selectedStudent.name} 학생에게 상점 ${selectedScore}점이 부여되었습니다`);

// 담임 선생님에게 알림 발송 (백그라운드)
try {
  const notifyResponse = await supabase.functions.invoke('notify-homeroom-teacher', {
    body: {
      notificationType: 'merit',  // 상점 알림 타입
      studentName: selectedStudent.name,
      studentGrade: selectedStudent.grade,
      studentClass: selectedStudent.class,
      studentNumber: selectedStudent.number,
      category: selectedCategory,
      reason: finalReason,
      score: selectedScore,
      teacherName: user.name,
      evidenceUrls: imageUrls.length > 0 ? imageUrls : undefined,  // 증빙사진!
    }
  });
  
  if (notifyResponse.data?.success) {
    console.log('담임 선생님 알림 발송 성공:', notifyResponse.data);
  }
} catch (notifyError) {
  console.error('담임 알림 발송 중 오류:', notifyError);
  // 알림 실패해도 상점 부여는 성공했으므로 에러 무시
}
```

> 💡 **포인트**: `evidenceUrls`로 증빙사진도 함께 전송해요!

---

## 2. 삭제 시 담임선생님 알림 기능

### 🎯 목표
교사가 자신이 부여한 상점/벌점/이달의학생을 삭제하면, 담임선생님에게 삭제 사실을 알리는 기능

### 📁 수정한 파일들

#### 2-1. Edge Function 수정 (`supabase/functions/notify-homeroom-teacher/index.ts`)

**알림 타입 추가:**
```typescript
interface NotifyRequest {
  notificationType: "demerit" | "monthly" | "merit" | "merit_delete" | "demerit_delete" | "monthly_delete";
  // ... 나머지 필드
}
```

**삭제 알림 이메일 템플릿 (상점 삭제 예시):**
```typescript
} else if (notificationType === "merit_delete") {
  // 상점 삭제 알림
  emailSubject = `🗑️ [상점 삭제] ${studentGrade}학년 ${studentClass}반 ${studentName} 학생 상점 삭제 안내`;
  
  emailHtml = `
    <div style="font-family: 'Apple SD Gothic Neo', 'Malgun Gothic', sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;">
      <div style="background: linear-gradient(135deg, #6b7280 0%, #4b5563 100%); padding: 20px; border-radius: 10px 10px 0 0;">
        <h1 style="color: white; margin: 0; font-size: 20px;">🗑️ 학생 상점 삭제 알림</h1>
      </div>
      <!-- 삭제된 내용은 취소선으로 표시 -->
      <td style="text-decoration: line-through;">${category || '-'}</td>
    </div>
  `;
}
```

> 💡 **포인트**: 삭제 알림은 회색 배경 + 취소선(line-through)으로 삭제됨을 표현해요!

#### 2-2. TeacherRecordsList 컴포넌트 수정 (`src/components/teacher/TeacherRecordsList.tsx`)

**handleDelete 함수 수정:**

```typescript
const handleDelete = async (type: "merit" | "demerit" | "monthly", id: string) => {
  if (!confirm("정말 삭제하시겠습니까?")) return;

  // 1️⃣ 삭제 전에 레코드 정보 저장 (알림용)
  let recordToDelete: any = null;
  if (type === "merit") {
    recordToDelete = merits.find(r => r.id === id);
  } else if (type === "demerit") {
    recordToDelete = demerits.find(r => r.id === id);
  } else if (type === "monthly") {
    recordToDelete = monthly.find(r => r.id === id);
  }

  try {
    // 2️⃣ 삭제 실행
    if (type === "merit") {
      const { error } = await supabase.rpc("teacher_delete_merit", {
        teacher_id_input: teacherId,
        merit_id_input: id,
      });
      if (error) throw error;
    }
    // ... 벌점, 이달의학생도 동일한 패턴

    // 3️⃣ 삭제 성공 토스트 (학생 이름 포함)
    const typeLabel = type === "merit" ? "상점" : type === "demerit" ? "벌점" : "이달의학생";
    toast.success(`${recordToDelete?.student_name || ''} 학생의 ${typeLabel}이 삭제되었습니다.`);
    loadRecords();

    // 4️⃣ 담임 선생님에게 삭제 알림 발송
    if (recordToDelete) {
      try {
        const authUser = localStorage.getItem("auth_user");
        const user = authUser ? JSON.parse(authUser) : null;
        
        // 타입에 따라 알림 타입 결정
        const notificationType = type === "merit" ? "merit_delete" 
          : type === "demerit" ? "demerit_delete" 
          : "monthly_delete";

        const notifyResponse = await supabase.functions.invoke('notify-homeroom-teacher', {
          body: {
            notificationType,
            studentName: recordToDelete.student_name,
            studentGrade: recordToDelete.student_grade,
            studentClass: recordToDelete.student_class,
            studentNumber: recordToDelete.student_number,
            category: recordToDelete.category,
            reason: recordToDelete.reason,
            score: recordToDelete.score,
            teacherName: user?.name || '-',
          }
        });
        
        // 5️⃣ 담임 알림 성공 시 두 번째 토스트
        if (notifyResponse.data?.success) {
          toast.info('담임선생님께 전달했습니다');
        }
      } catch (notifyError) {
        console.error('담임 삭제 알림 발송 중 오류:', notifyError);
      }
    }
  } catch (error: any) {
    toast.error("삭제 실패: " + error.message);
  }
};
```

---

## 3. 이메일 푸터 텍스트 일괄 변경

### 변경 내용
- "School Point" → "School Life"로 변경
- 문의 연락처를 "교무실" → "gyeongjuhs@naver.com"으로 변경

### 수정한 파일들
1. `supabase/functions/notify-homeroom-teacher/index.ts`
2. `supabase/functions/send-bulk-email/index.ts`
3. `supabase/functions/send-email/index.ts`

**변경 전:**
```html
<p>이 메일은 School Point 시스템에서 자동으로 발송되었습니다.<br>
문의사항이 있으시면 교무실로 연락해 주세요.</p>
```

**변경 후:**
```html
<p>이 메일은 School Life 시스템에서 자동으로 발송되었습니다.<br>
문의사항이 있으시면 gyeongjuhs@naver.com로 연락해 주세요.</p>
```

---

## 4. 교사 대시보드 탭 테마 색상 적용

### 🎯 목표
교사 대시보드의 그룹, 일괄발송, 발송이력 탭에 각각 고유한 테마 색상을 적용하여 시각적 구분 강화

### 🎨 색상 체계
| 탭 | 색상 | HSL 값 |
|---|---|---|
| 그룹 | 보라색 (Purple) | 270 70% 55% |
| 일괄발송 | 분홍색 (Pink) | 330 80% 60% |
| 발송이력 | 청록색 (Teal) | 180 70% 45% |

### 📁 수정한 파일들

#### 4-1. 디자인 시스템에 색상 변수 추가 (`src/index.css`)

```css
:root {
  /* Tab Colors - 라이트 모드 */
  --groups-purple: 270 70% 55%;
  --groups-purple-hover: 270 70% 47%;
  --bulk-email-pink: 330 80% 60%;
  --bulk-email-pink-hover: 330 80% 52%;
  --email-history-teal: 180 70% 45%;
  --email-history-teal-hover: 180 70% 37%;
}

.dark {
  /* Tab Colors - 다크 모드 */
  --groups-purple: 270 70% 60%;
  --groups-purple-hover: 270 70% 68%;
  --bulk-email-pink: 330 80% 65%;
  --bulk-email-pink-hover: 330 80% 73%;
  --email-history-teal: 180 70% 50%;
  --email-history-teal-hover: 180 70% 58%;
}
```

> 💡 **포인트**: 다크 모드에서는 명도를 높여서 가시성을 확보해요!

#### 4-2. Tailwind 설정에 색상 등록 (`tailwind.config.ts`)

```typescript
colors: {
  groups: {
    purple: "hsl(var(--groups-purple))",
    "purple-hover": "hsl(var(--groups-purple-hover))",
  },
  "bulk-email": {
    pink: "hsl(var(--bulk-email-pink))",
    "pink-hover": "hsl(var(--bulk-email-pink-hover))",
  },
  "email-history": {
    teal: "hsl(var(--email-history-teal))",
    "teal-hover": "hsl(var(--email-history-teal-hover))",
  },
}
```

#### 4-3. 교사 대시보드 메인 탭 (`src/pages/teacher/Dashboard.tsx`)

```tsx
<TabsTrigger 
  value="groups" 
  className="data-[state=active]:bg-groups-purple data-[state=active]:text-white"
>
  <Users className="w-4 h-4 mr-2" />
  그룹
</TabsTrigger>

<TabsTrigger 
  value="bulk-email" 
  className="data-[state=active]:bg-bulk-email-pink data-[state=active]:text-white"
>
  <Mail className="w-4 h-4 mr-2" />
  일괄발송
</TabsTrigger>

<TabsTrigger 
  value="email-history" 
  className="data-[state=active]:bg-email-history-teal data-[state=active]:text-white"
>
  <History className="w-4 h-4 mr-2" />
  발송이력
</TabsTrigger>
```

#### 4-4. 그룹 탭 내부 컴포넌트들

**GroupTabs.tsx** - 학생/교사 선택 탭에 보라색 적용:
```tsx
<TabsList className="bg-groups-purple/10">
  <TabsTrigger 
    value="students"
    className="data-[state=active]:bg-groups-purple data-[state=active]:text-white"
  >
    학생 선택
  </TabsTrigger>
</TabsList>
```

**StudentGroupManager.tsx / TeacherGroupManager.tsx** - 카드 테두리와 제목:
```tsx
<Card className="border-groups-purple/30">
  <CardTitle className="text-groups-purple">
    <Users className="w-5 h-5" />
    학생 선택
  </CardTitle>
</Card>

<Button className="bg-groups-purple hover:bg-groups-purple-hover">
  저장
</Button>
```

#### 4-5. 일괄발송 컴포넌트 (`src/components/teacher/BulkEmailSender.tsx`)

```tsx
<Card className="border-bulk-email-pink/30">
  <CardTitle className="text-bulk-email-pink">
    <Mail className="w-5 h-5" />
    일괄 메시지 발송
  </CardTitle>
</Card>

<TabsList className="bg-bulk-email-pink/10">
  <TabsTrigger className="data-[state=active]:bg-bulk-email-pink data-[state=active]:text-white">
    학생
  </TabsTrigger>
</TabsList>

<Button className="bg-bulk-email-pink hover:bg-bulk-email-pink-hover">
  일괄 발송
</Button>
```

#### 4-6. 발송이력 컴포넌트 (`src/components/teacher/EmailHistory.tsx`)

```tsx
<Card className="border-email-history-teal/30">
  <CardTitle className="text-email-history-teal">
    <Mail className="w-4 h-4" />
    발송 이력
  </CardTitle>
</Card>

<TabsList className="bg-email-history-teal/10">
  <TabsTrigger className="data-[state=active]:bg-email-history-teal data-[state=active]:text-white">
    학생
  </TabsTrigger>
</TabsList>
```

---

## 5. 관리자 대시보드 통계 탭 테마 색상 적용

### 🎯 목표
관리자 대시보드의 통계 메뉴에서 전교생통계, 학급통계, 학년추이 탭에 각각 고유한 테마 색상을 적용

### 🎨 색상 체계
| 탭 | 색상 | 사용한 CSS 변수 |
|---|---|---|
| 전교생통계 | 보라색 (Purple) | `--groups-purple` |
| 학급통계 | 분홍색 (Pink) | `--bulk-email-pink` |
| 학년추이 | 청록색 (Teal) | `--email-history-teal` |

> 💡 **포인트**: 교사 대시보드에서 이미 만들어둔 색상 변수를 재사용했어요!

### 📁 수정한 파일들

#### 5-1. 통계 탭 컨테이너 (`src/components/admin/UnifiedStatistics.tsx`)

```tsx
<TabsList className="grid w-full grid-cols-3 bg-muted/50">
  <TabsTrigger 
    value="grade" 
    className="data-[state=active]:bg-groups-purple data-[state=active]:text-white"
  >
    전교생통계
  </TabsTrigger>
  <TabsTrigger 
    value="class" 
    className="data-[state=active]:bg-bulk-email-pink data-[state=active]:text-white"
  >
    학급통계
  </TabsTrigger>
  <TabsTrigger 
    value="trend" 
    className="data-[state=active]:bg-email-history-teal data-[state=active]:text-white"
  >
    학년추이
  </TabsTrigger>
</TabsList>
```

#### 5-2. 전교생통계 컴포넌트 (`src/components/admin/GradeStatistics.tsx`)

```tsx
<Card className="border-groups-purple/30">
  <CardHeader>
    <CardTitle className="text-groups-purple">학년별 상점/벌점 통계</CardTitle>
  </CardHeader>
</Card>

<Button className="bg-groups-purple hover:bg-groups-purple-hover">
  조회
</Button>

<Button variant="outline" className="border-groups-purple/50 text-groups-purple hover:bg-groups-purple/10">
  CSV 내보내기
</Button>
```

#### 5-3. 학급통계 컴포넌트 (`src/components/admin/StatisticsChart.tsx`)

```tsx
<Card className="border-bulk-email-pink/30">
  <CardHeader>
    <CardTitle className="text-bulk-email-pink">학급별 월별 상점/벌점 통계</CardTitle>
  </CardHeader>
</Card>

<Button className="bg-bulk-email-pink hover:bg-bulk-email-pink-hover">
  조회
</Button>

<Button variant="outline" className="border-bulk-email-pink/50 text-bulk-email-pink hover:bg-bulk-email-pink/10">
  CSV 내보내기
</Button>
```

#### 5-4. 학년추이 컴포넌트 (`src/components/admin/GradeMonthlyTrend.tsx`)

```tsx
<Card className="border-email-history-teal/30">
  <CardHeader>
    <CardTitle className="text-email-history-teal">학년별 월별 추이</CardTitle>
  </CardHeader>
</Card>

<Button className="bg-email-history-teal hover:bg-email-history-teal-hover">
  조회
</Button>

<Button variant="outline" className="border-email-history-teal/50 text-email-history-teal hover:bg-email-history-teal/10">
  CSV 내보내기
</Button>
```

### 💡 디자인 패턴: outline 버튼 스타일링

일반 버튼과 outline 버튼에 같은 테마 색상을 적용하는 패턴:

```tsx
// 기본 버튼 - 배경색 사용
<Button className="bg-groups-purple hover:bg-groups-purple-hover">
  조회
</Button>

// outline 버튼 - 테두리, 글자색, 호버 배경에 투명도 적용
<Button variant="outline" className="border-groups-purple/50 text-groups-purple hover:bg-groups-purple/10">
  CSV 내보내기
</Button>
```

| 속성 | 설명 |
|---|---|
| `border-{color}/50` | 테두리에 50% 투명도 적용 (은은하게) |
| `text-{color}` | 글자색을 테마 색상으로 |
| `hover:bg-{color}/10` | 호버 시 10% 투명도의 배경색 (살짝 채워지는 효과) |

---

## 6. 관리자 대시보드 데이터 조회 메뉴 테마 적용

### 🎯 목표
관리자 대시보드의 "데이터 조회" 메뉴에 인디고(남색) 테마를 적용하여 다른 메뉴와 시각적 구분

### 🎨 색상 체계
| 메뉴 | 색상 | HSL 값 |
|---|---|---|
| 데이터 조회 | 인디고 (Indigo) | 240 60% 55% |

### 📁 수정한 파일들

#### 6-1. CSS 변수 추가 (`src/index.css`)

```css
:root {
  /* 기존 Tab Colors에 추가 */
  --data-inquiry-indigo: 240 60% 55%;
  --data-inquiry-indigo-hover: 240 60% 47%;
}

.dark {
  --data-inquiry-indigo: 240 60% 60%;
  --data-inquiry-indigo-hover: 240 60% 68%;
}
```

> 💡 **포인트**: 인디고(Indigo)는 파란색과 보라색 사이의 색상이에요! HSL에서 240은 순수한 파란색(Blue)입니다.

#### 6-2. Tailwind 설정에 색상 등록 (`tailwind.config.ts`)

```typescript
colors: {
  "data-inquiry": {
    indigo: "hsl(var(--data-inquiry-indigo))",
    "indigo-hover": "hsl(var(--data-inquiry-indigo-hover))",
  },
}
```

#### 6-3. 데이터 조회 컴포넌트 (`src/components/admin/DataInquiry.tsx`)

```tsx
<Card className="border-data-inquiry-indigo/30">
  <CardHeader>
    <CardTitle className="text-data-inquiry-indigo">데이터 조회</CardTitle>
  </CardHeader>
</Card>

<Button className="bg-data-inquiry-indigo hover:bg-data-inquiry-indigo-hover">
  검색
</Button>
```

### 💡 HSL 색상 체계 이해하기

HSL은 **H**ue(색상), **S**aturation(채도), **L**ightness(명도)의 약자예요:

| 값 | 의미 | 범위 |
|---|---|---|
| H (Hue) | 색상 - 색상환에서의 각도 | 0-360 |
| S (Saturation) | 채도 - 색의 선명도 | 0%-100% |
| L (Lightness) | 명도 - 밝기 | 0%-100% |

**색상환 기준:**
- 0° / 360° = 빨강 (Red)
- 60° = 노랑 (Yellow)
- 120° = 초록 (Green)
- 180° = 청록 (Cyan/Teal)
- 240° = 파랑 (Blue/Indigo)
- 270° = 보라 (Purple)
- 300° = 마젠타 (Magenta)
- 330° = 분홍 (Pink)

---

## 7. 학생 대시보드 상세내역 탭 테마 적용

### 🎯 목표
학생 대시보드의 "상세내역" 섹션에서 상점, 벌점, 이달의학생 탭에 각각 고유한 테마 색상을 적용

### 🎨 색상 체계
| 탭 | 색상 | 사용한 CSS 변수 |
|---|---|---|
| 상점 | 파란색 (Blue) | `--merit-blue` |
| 벌점 | 주황색 (Orange) | `--demerit-orange` |
| 이달의학생 | 초록색 (Green) | `--monthly-green` |

> 💡 **포인트**: 기존 디자인 시스템에 정의된 상점/벌점/이달의학생 색상 변수를 재사용했어요!

### 📁 수정한 파일 (`src/pages/student/Dashboard.tsx`)

#### 7-1. 탭 트리거 스타일링

```tsx
<TabsTrigger 
  value="merits"
  className="data-[state=active]:bg-merit-blue data-[state=active]:text-white"
>
  상점 ({meritScore}점)
</TabsTrigger>

<TabsTrigger 
  value="demerits"
  className="data-[state=active]:bg-demerit-orange data-[state=active]:text-white"
>
  벌점 ({demeritScore}점)
</TabsTrigger>

<TabsTrigger 
  value="monthly"
  className="data-[state=active]:bg-monthly-green data-[state=active]:text-white"
>
  이달의 학생 ({monthlyCount}회)
</TabsTrigger>
```

#### 7-2. 테이블 테두리 색상

```tsx
{/* 상점 테이블 */}
<Table className="border border-merit-blue/30">
  {/* ... */}
</Table>

{/* 벌점 테이블 */}
<Table className="border border-demerit-orange/30">
  {/* ... */}
</Table>

{/* 이달의학생 테이블 */}
<Table className="border border-monthly-green/30">
  {/* ... */}
</Table>
```

#### 7-3. CSV 다운로드 버튼 스타일링

```tsx
{/* 상점 CSV 버튼 */}
<Button 
  variant="outline" 
  size="sm" 
  className="border-merit-blue text-merit-blue hover:bg-merit-blue/10"
>
  <FileDown className="w-4 h-4 mr-1" />
  CSV
</Button>

{/* 벌점 CSV 버튼 */}
<Button 
  variant="outline" 
  size="sm" 
  className="border-demerit-orange text-demerit-orange hover:bg-demerit-orange/10"
>
  <FileDown className="w-4 h-4 mr-1" />
  CSV
</Button>

{/* 이달의학생 CSV 버튼 */}
<Button 
  variant="outline" 
  size="sm" 
  className="border-monthly-green text-monthly-green hover:bg-monthly-green/10"
>
  <FileDown className="w-4 h-4 mr-1" />
  CSV
</Button>
```

### 💡 학생용 테마의 의미

상점, 벌점, 이달의학생에 고유한 색상을 적용하면:

1. **직관적 구분**: 학생이 어떤 내역을 보고 있는지 색상만으로 즉시 파악
2. **일관성**: 전체 시스템에서 상점=파랑, 벌점=주황, 이달의학생=초록이라는 색상 규칙 유지
3. **사용자 경험**: 탭, 테이블, 버튼이 같은 색상 계열로 통일되어 시각적 완성도 향상

---

## 8. 교사 대시보드 상점/벌점/이달의학생 탭 테마 적용

### 🎯 목표
교사 대시보드의 상점, 벌점, 이달의학생 탭에 각각 고유한 테마 색상을 적용하여 시각적 일관성 유지

### 🎨 색상 체계
| 탭 | 색상 | 사용한 CSS 변수 |
|---|---|---|
| 상점 | 파란색 (Blue) | `--merit-blue` |
| 벌점 | 주황색 (Orange) | `--demerit-orange` |
| 이달의학생 | 초록색 (Green) | `--monthly-green` |

> 💡 **포인트**: 학생 대시보드와 동일한 색상 변수를 사용하여 시스템 전체 일관성 유지!

### 📁 수정한 파일들

#### 8-1. 교사 대시보드 메인 탭 (`src/pages/teacher/Dashboard.tsx`)

**탭 트리거 스타일링:**
```tsx
<TabsTrigger 
  value="merit"
  className="data-[state=active]:bg-merit-blue data-[state=active]:text-white"
>
  <Award className="w-4 h-4 mr-2" />
  상점
</TabsTrigger>

<TabsTrigger 
  value="demerit"
  className="data-[state=active]:bg-demerit-orange data-[state=active]:text-white"
>
  <AlertCircle className="w-4 h-4 mr-2" />
  벌점
</TabsTrigger>

<TabsTrigger 
  value="monthly"
  className="data-[state=active]:bg-monthly-green data-[state=active]:text-white"
>
  <Star className="w-4 h-4 mr-2" />
  이달의학생
</TabsTrigger>
```

**카드 컨테이너 스타일링:**
```tsx
{/* 상점 카드 */}
<Card className="border-merit-blue/30">
  <CardHeader>
    <CardTitle className="text-merit-blue">상점 부여</CardTitle>
  </CardHeader>
</Card>

{/* 벌점 카드 */}
<Card className="border-demerit-orange/30">
  <CardHeader>
    <CardTitle className="text-demerit-orange">벌점 부여</CardTitle>
  </CardHeader>
</Card>

{/* 이달의학생 카드 */}
<Card className="border-monthly-green/30">
  <CardHeader>
    <CardTitle className="text-monthly-green">이달의 학생 추천</CardTitle>
  </CardHeader>
</Card>
```

#### 8-2. 상점 입력 폼 (`src/components/teacher/MeritForm.tsx`)

```tsx
{/* 선택된 학생 카드 */}
<Card className="bg-merit-blue/10 border-merit-blue">
  <CardContent>
    <span className="font-semibold text-merit-blue">선택된 학생:</span>
  </CardContent>
</Card>

{/* 점수 표시 카드 */}
<Card className="bg-merit-blue/5 border-merit-blue">
  <span className="text-2xl font-bold text-merit-blue">{selectedScore}점</span>
</Card>

{/* 제출 버튼 */}
<Button className="w-full bg-merit-blue hover:bg-merit-blue/90">
  상점 부여
</Button>
```

#### 8-3. 벌점 입력 폼 (`src/components/teacher/DemeritForm.tsx`)

```tsx
{/* 선택된 학생 카드 */}
<Card className="bg-demerit-orange/10 border-demerit-orange">
  <CardContent>
    <span className="font-semibold text-demerit-orange">선택된 학생:</span>
  </CardContent>
</Card>

{/* 점수 표시 카드 */}
<Card className="bg-demerit-orange/5 border-demerit-orange">
  <span className="text-2xl font-bold text-demerit-orange">{selectedScore}점</span>
</Card>

{/* 제출 버튼 */}
<Button className="w-full bg-demerit-orange hover:bg-demerit-orange/90">
  벌점 부여
</Button>
```

#### 8-4. 이달의학생 입력 폼 (`src/components/teacher/MonthlyForm.tsx`)

```tsx
{/* 선택된 학생 카드 */}
<Card className="bg-monthly-green/10 border-monthly-green">
  <CardContent>
    <span className="font-semibold text-monthly-green">선택된 학생:</span>
  </CardContent>
</Card>

{/* 제출 버튼 */}
<Button className="w-full bg-monthly-green hover:bg-monthly-green/90">
  이달의 학생 추천
</Button>
```

### 💡 교사용 테마의 의미

교사 대시보드에 상점/벌점/이달의학생 색상 테마를 적용하면:

1. **학생 대시보드와 일관성**: 교사가 입력한 색상 → 학생이 보는 색상이 동일
2. **직관적 입력**: 어떤 종류의 점수를 부여하는지 색상으로 즉시 인지
3. **시각적 피드백**: 선택된 학생 카드, 점수 표시, 제출 버튼이 모두 같은 색상

---

## 📚 배운 개념 정리

### 1. 조건부 알림 타입 (Conditional Notification Type)
```typescript
// 삼항 연산자를 연속으로 사용해서 타입 결정
const notificationType = type === "merit" ? "merit_delete" 
  : type === "demerit" ? "demerit_delete" 
  : "monthly_delete";
```

### 2. 삭제 전 데이터 저장
```typescript
// 삭제하기 전에 필요한 정보를 미리 저장해두기
let recordToDelete = merits.find(r => r.id === id);
// ... 삭제 실행 후에도 recordToDelete로 접근 가능!
```

### 3. 백그라운드 작업과 에러 처리
```typescript
try {
  // 알림 발송 시도
  const notifyResponse = await supabase.functions.invoke('notify-homeroom-teacher', {...});
} catch (notifyError) {
  // 알림 실패해도 메인 작업(삭제)은 이미 성공했으므로
  // 사용자에게 에러를 보여주지 않고 로그만 남김
  console.error('알림 발송 오류:', notifyError);
}
```

### 4. 토스트 알림 종류
```typescript
toast.success('성공 메시지');  // 초록색 - 성공
toast.error('에러 메시지');    // 빨간색 - 실패
toast.info('정보 메시지');     // 파란색 - 정보
toast.warning('경고 메시지');  // 노란색 - 경고
```

### 5. CSS 변수로 디자인 시스템 만들기
```css
/* index.css에서 색상 변수 정의 */
:root {
  --groups-purple: 270 70% 55%;  /* HSL 값: 색상 채도% 명도% */
}

/* 다크 모드에서는 명도를 높여서 가시성 확보 */
.dark {
  --groups-purple: 270 70% 60%;
}
```

### 6. Tailwind에서 CSS 변수 사용하기
```typescript
// tailwind.config.ts
colors: {
  groups: {
    purple: "hsl(var(--groups-purple))",  // CSS 변수를 hsl()로 감싸기
  },
}
```

### 7. Tailwind data 속성 스타일링
```tsx
// data-[state=active]는 Radix UI 컴포넌트의 상태를 감지
<TabsTrigger 
  className="data-[state=active]:bg-groups-purple data-[state=active]:text-white"
>
  // 탭이 활성화되면 자동으로 배경색과 글자색 변경!
</TabsTrigger>
```

### 8. 투명도 적용 (opacity)
```tsx
// 색상 뒤에 /숫자를 붙이면 투명도 적용
<Card className="border-groups-purple/30">  // 30% 불투명도
<TabsList className="bg-bulk-email-pink/10">  // 10% 불투명도 (은은한 배경)
```

---

## ✅ 테스트 체크리스트

- [x] 상점 부여 시 담임선생님에게 이메일 발송됨
- [x] 상점 부여 시 증빙사진이 이메일에 포함됨
- [x] 벌점 삭제 시 담임선생님에게 이메일 발송됨
- [x] 상점 삭제 시 담임선생님에게 이메일 발송됨
- [x] 이달의학생 삭제 시 담임선생님에게 이메일 발송됨
- [x] 그룹 탭에 보라색 테마 적용됨
- [x] 일괄발송 탭에 분홍색 테마 적용됨
- [x] 발송이력 탭에 청록색 테마 적용됨
- [x] 관리자 통계 - 전교생통계 탭에 보라색 테마 적용됨
- [x] 관리자 통계 - 학급통계 탭에 분홍색 테마 적용됨
- [x] 관리자 통계 - 학년추이 탭에 청록색 테마 적용됨
- [x] 관리자 데이터 조회 메뉴에 인디고 테마 적용됨
- [x] 학생 대시보드 상점 탭에 파란색 테마 적용됨
- [x] 학생 대시보드 벌점 탭에 주황색 테마 적용됨
- [x] 학생 대시보드 이달의학생 탭에 초록색 테마 적용됨
- [x] 교사 대시보드 상점 탭에 파란색 테마 적용됨
- [x] 교사 대시보드 벌점 탭에 주황색 테마 적용됨
- [x] 교사 대시보드 이달의학생 탭에 초록색 테마 적용됨

---

## 🔧 Edge Function 배포 방법

Edge Function을 수정한 후에는 배포가 필요합니다:

```bash
# Lovable에서는 자동 배포됨
# 로컬 개발 환경에서는:
supabase functions deploy notify-homeroom-teacher
```

---

## 📝 연습 문제

1. **타입 추가 연습**: 만약 "출석 알림" 기능을 추가하려면 `notificationType`에 어떤 값을 추가해야 할까요?

2. **조건문 연습**: 다음 코드의 결과는?
```typescript
const type = "demerit";
const label = type === "merit" ? "상점" : type === "demerit" ? "벌점" : "이달의학생";
console.log(label); // 출력: ?
```

3. **에러 처리 연습**: 왜 알림 발송 실패 시 `toast.error()`를 호출하지 않을까요?

4. **CSS 변수 연습**: 새로운 "공지사항" 탭에 노란색(yellow) 테마를 추가하려면 어떤 CSS 변수를 만들어야 할까요?

5. **투명도 연습**: `bg-primary/50`은 어떤 의미일까요?

---

**작성일**: 2025년 12월 16일  
**작성자**: School Life 개발팀
