# ğŸš¨ MindTalk ìœ„í—˜ ì•Œë¦¼ ì‹œìŠ¤í…œ ê°€ì´ë“œ

> ì¤‘í•™ìƒë„ ë”°ë¼í•  ìˆ˜ ìˆëŠ” ìœ„í—˜ ê°ì§€ ë° ì•Œë¦¼ ì‹œìŠ¤í…œ ê°œë°œ ê°€ì´ë“œ

---

## ğŸ“š ëª©ì°¨

1. [ìœ„í—˜ ì•Œë¦¼ ì‹œìŠ¤í…œì´ë€?](#1-ìœ„í—˜-ì•Œë¦¼-ì‹œìŠ¤í…œì´ë€)
2. [ì‹œìŠ¤í…œ ì „ì²´ íë¦„](#2-ì‹œìŠ¤í…œ-ì „ì²´-íë¦„)
3. [í”„ë¡ íŠ¸ì—”ë“œ ì½”ë“œ ë¶„ì„](#3-í”„ë¡ íŠ¸ì—”ë“œ-ì½”ë“œ-ë¶„ì„)
4. [Edge Function ì½”ë“œ ë¶„ì„](#4-edge-function-ì½”ë“œ-ë¶„ì„)
5. [ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡°](#5-ë°ì´í„°ë² ì´ìŠ¤-êµ¬ì¡°)
6. [ì´ë©”ì¼ í…œí”Œë¦¿ ë””ìì¸](#6-ì´ë©”ì¼-í…œí”Œë¦¿-ë””ìì¸)
7. [ë³´ì•ˆ ë° ê°œì¸ì •ë³´ ë³´í˜¸](#7-ë³´ì•ˆ-ë°-ê°œì¸ì •ë³´-ë³´í˜¸)
8. [ì‹¤ìŠµ ê³¼ì œ](#8-ì‹¤ìŠµ-ê³¼ì œ)

---

## 1. ìœ„í—˜ ì•Œë¦¼ ì‹œìŠ¤í…œì´ë€?

MindTalk ìœ„í—˜ ì•Œë¦¼ ì‹œìŠ¤í…œì€ í•™ìƒë“¤ì˜ ëŒ€í™”ì—ì„œ **ìí•´, ìì‚´, í­ë ¥** ë“±ì˜ ìœ„í—˜ ë‹¨ì–´ë¥¼ ê°ì§€í•˜ì—¬ ë‹´ì„ì„ ìƒë‹˜ì—ê²Œ ìë™ìœ¼ë¡œ ì•Œë¦¼ì„ ë³´ë‚´ëŠ” ì‹œìŠ¤í…œì…ë‹ˆë‹¤.

### í•µì‹¬ ê¸°ëŠ¥

| ê¸°ëŠ¥ | ì„¤ëª… |
|------|------|
| ğŸ” ìœ„í—˜ ë‹¨ì–´ ê°ì§€ | í•™ìƒ ë©”ì‹œì§€ì—ì„œ ìœ„í—˜ í‚¤ì›Œë“œ ê²€ì‚¬ |
| ğŸ“Š ëˆ„ì  ì¹´ìš´íŠ¸ | ìœ„í—˜ ë‹¨ì–´ ì‚¬ìš© íšŸìˆ˜ ëˆ„ì  ê´€ë¦¬ |
| ğŸ“§ ìë™ ì•Œë¦¼ | ë‹´ì„ì„ ìƒë‹˜ì—ê²Œ ì´ë©”ì¼ ì•Œë¦¼ ë°œì†¡ |
| ğŸ“ˆ ì•Œë¦¼ ì£¼ê¸° ê´€ë¦¬ | 3íšŒë§ˆë‹¤ ì•Œë¦¼ (ê³¼ë„í•œ ì•Œë¦¼ ë°©ì§€) |

### ì‚¬ìš© ê¸°ìˆ 

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ì‚¬ìš© ê¸°ìˆ  ìŠ¤íƒ                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ React + TypeScript    - í”„ë¡ íŠ¸ì—”ë“œ                       â”‚
â”‚  â€¢ Supabase Database     - ë°ì´í„° ì €ì¥                      â”‚
â”‚  â€¢ Supabase Edge Function - ì„œë²„ ë¡œì§                       â”‚
â”‚  â€¢ Resend API            - ì´ë©”ì¼ ë°œì†¡                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ì‹œìŠ¤í…œ ì „ì²´ íë¦„

### 2.1 ì „ì²´ ì•„í‚¤í…ì²˜

```
í•™ìƒì´ ë©”ì‹œì§€ ì…ë ¥
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. ìœ„í—˜ ë‹¨ì–´ ê²€ì‚¬      â”‚  â† í”„ë¡ íŠ¸ì—”ë“œ (MindTalk.tsx)
â”‚    checkDangerousWords â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
    ìœ„í—˜ ë‹¨ì–´ ìˆìŒ?
        â”‚
    â”Œâ”€â”€â”€â”´â”€â”€â”€â”
   Yes     No
    â”‚       â”‚
    â–¼       â””â”€â”€â–¶ ì¼ë°˜ ëŒ€í™” ì§„í–‰
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. DB ì¹´ìš´íŠ¸ ì—…ë°ì´íŠ¸   â”‚  â† RPC í•¨ìˆ˜ í˜¸ì¶œ
â”‚    update_mindtalk_    â”‚
â”‚    danger_count        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. ì•Œë¦¼ ì¡°ê±´ í™•ì¸      â”‚
â”‚    total >= 3 AND      â”‚
â”‚    (total - last) >= 3 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
    ì•Œë¦¼ í•„ìš”?
        â”‚
    â”Œâ”€â”€â”€â”´â”€â”€â”€â”
   Yes     No
    â”‚       â”‚
    â–¼       â””â”€â”€â–¶ ì¹´ìš´íŠ¸ë§Œ ì €ì¥
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. Edge Function í˜¸ì¶œ  â”‚  â† mindtalk-alert
â”‚    ë‹´ì„ì„ ìƒë‹˜ ì´ë©”ì¼    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. ì•Œë¦¼ ë°œì†¡ ê¸°ë¡      â”‚  â† DB ì—…ë°ì´íŠ¸
â”‚    update_mindtalk_    â”‚
â”‚    alert_sent          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 ì•Œë¦¼ ë°œì†¡ ì¡°ê±´

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ì•Œë¦¼ ë°œì†¡ ì¡°ê±´                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  ì¡°ê±´ 1: total_count >= 3                                   â”‚
â”‚          (ì´ ìœ„í—˜ ë‹¨ì–´ 3ê°œ ì´ìƒ ëˆ„ì )                         â”‚
â”‚                                                             â”‚
â”‚  ì¡°ê±´ 2: total_count - last_alert_count >= 3                â”‚
â”‚          (ë§ˆì§€ë§‰ ì•Œë¦¼ ì´í›„ 3ê°œ ì´ìƒ ì¶”ê°€)                     â”‚
â”‚                                                             â”‚
â”‚  ì˜ˆì‹œ:                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ ì´ ì¹´ìš´íŠ¸ â”‚ ë§ˆì§€ë§‰ì•Œë¦¼ â”‚ ì•Œë¦¼ ë°œì†¡ ì—¬ë¶€        â”‚           â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”‚
â”‚  â”‚    1     â”‚     0      â”‚ âŒ (3ê°œ ë¯¸ë§Œ)         â”‚           â”‚
â”‚  â”‚    2     â”‚     0      â”‚ âŒ (3ê°œ ë¯¸ë§Œ)         â”‚           â”‚
â”‚  â”‚    3     â”‚     0      â”‚ âœ… (3ê°œ ë„ë‹¬!)        â”‚           â”‚
â”‚  â”‚    4     â”‚     3      â”‚ âŒ (ì°¨ì´ 1)          â”‚           â”‚
â”‚  â”‚    5     â”‚     3      â”‚ âŒ (ì°¨ì´ 2)          â”‚           â”‚
â”‚  â”‚    6     â”‚     3      â”‚ âœ… (ì°¨ì´ 3!)         â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. í”„ë¡ íŠ¸ì—”ë“œ ì½”ë“œ ë¶„ì„

íŒŒì¼ ìœ„ì¹˜: `src/components/student/MindTalk.tsx`

### 3.1 ìœ„í—˜ ë‹¨ì–´ ëª©ë¡ ì •ì˜

```tsx
// ê°ì§€í•  ìœ„í—˜ ë‹¨ì–´ ëª©ë¡
const DANGEROUS_WORDS = [
  'ìì‚´', 'ì£½ê³  ì‹¶', 'ì£½ì–´ë²„ë¦¬', 'ì£½ì„ë˜', 'ì£½ê² ',
  'í­ë ¥', 'ë•Œë¦¬ê³  ì‹¶', 'ë•Œë ¤ì£½', 'íŒ¨ì£½', 'ì¹¼', 'ì¹¼ë¡œ',
  'ëª©ë§¤', 'ë›°ì–´ë‚´ë¦¬', 'ì•½ ë¨¹ê³ ', 'ì†ëª©', 'ìí•´',
  'ì£½ì—¬ë²„ë¦¬', 'ì‚´ì¸', 'ë³µìˆ˜', 'ì—†ì–´ì§€ê³  ì‹¶', 'ì‚¬ë¼ì§€ê³  ì‹¶'
];
```

#### ğŸ’¡ ë°°ì—´(Array)ì´ë€?

```
ë°°ì—´ì€ ì—¬ëŸ¬ ê°œì˜ ê°’ì„ í•˜ë‚˜ì˜ ë³€ìˆ˜ì— ë‹´ëŠ” ê²ƒì…ë‹ˆë‹¤.

const fruits = ['ì‚¬ê³¼', 'ë°”ë‚˜ë‚˜', 'ë”¸ê¸°'];
//    ì´ë¦„      0ë²ˆì§¸    1ë²ˆì§¸     2ë²ˆì§¸

fruits[0]  â†’ 'ì‚¬ê³¼'
fruits[1]  â†’ 'ë°”ë‚˜ë‚˜'
fruits.length â†’ 3 (ê°œìˆ˜)
```

### 3.2 ìœ„í—˜ ë‹¨ì–´ ê²€ì‚¬ í•¨ìˆ˜

```tsx
const checkDangerousWords = (text: string): number => {
  let count = 0;
  DANGEROUS_WORDS.forEach(word => {
    if (text.includes(word)) {
      count++;
    }
  });
  return count;
};
```

#### ì½”ë“œ í•œ ì¤„ì”© ì´í•´í•˜ê¸°

```tsx
const checkDangerousWords = (text: string): number => {
  // ì´ í•¨ìˆ˜ëŠ” textë¥¼ ë°›ì•„ì„œ ìˆ«ì(number)ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤
  
  let count = 0;
  // count ë³€ìˆ˜ë¥¼ 0ìœ¼ë¡œ ì‹œì‘
  
  DANGEROUS_WORDS.forEach(word => {
    // ìœ„í—˜ ë‹¨ì–´ ëª©ë¡ì„ í•˜ë‚˜ì”© ëŒë©´ì„œ (forEach = ê°ê°ì— ëŒ€í•´)
    
    if (text.includes(word)) {
      // text ì•ˆì— wordê°€ í¬í•¨ë˜ì–´ ìˆìœ¼ë©´
      
      count++;
      // countë¥¼ 1 ì¦ê°€
    }
  });
  
  return count;
  // ì´ ëª‡ ê°œì˜ ìœ„í—˜ ë‹¨ì–´ê°€ ìˆì—ˆëŠ”ì§€ ë°˜í™˜
};
```

#### ì˜ˆì‹œë¡œ ì´í•´í•˜ê¸°

```
text = "ìš”ì¦˜ ì£½ê³  ì‹¶ì–´, ë„ˆë¬´ í˜ë“¤ì–´"

ê²€ì‚¬ ê³¼ì •:
â”œâ”€â”€ 'ìì‚´' í¬í•¨? â†’ No
â”œâ”€â”€ 'ì£½ê³  ì‹¶' í¬í•¨? â†’ Yes! count = 1
â”œâ”€â”€ 'ì£½ì–´ë²„ë¦¬' í¬í•¨? â†’ No
â”œâ”€â”€ ... (ê³„ì† ê²€ì‚¬)
â””â”€â”€ ê²°ê³¼: count = 1
```

### 3.3 ë©”ì‹œì§€ ì „ì†¡ ì‹œ ìœ„í—˜ ë‹¨ì–´ ì²˜ë¦¬

```tsx
const sendMessage = useCallback(async () => {
  // ... ìƒëµ ...

  // ìœ„í—˜ ë‹¨ì–´ ì²´í¬
  const dangerWordsInMessage = checkDangerousWords(userMessage.content);
  
  if (dangerWordsInMessage > 0) {
    // ìœ„í—˜ ë‹¨ì–´ê°€ 1ê°œ ì´ìƒ ë°œê²¬ë¨!
    
    // DBì—ì„œ ì¹´ìš´íŠ¸ ì—…ë°ì´íŠ¸í•˜ê³  ì•Œë¦¼ í•„ìš” ì—¬ë¶€ í™•ì¸
    const { data: updateResult } = await supabase.rpc('update_mindtalk_danger_count', {
      student_id_input: studentId,
      increment_by: dangerWordsInMessage
    });

    if (updateResult && updateResult[0]) {
      const { total_count, should_alert } = updateResult[0];
      setDangerCount(total_count);

      // ì•Œë¦¼ ì¡°ê±´ ì¶©ì¡± ì‹œ ë‹´ì„ì„ ìƒë‹˜ì—ê²Œ ì•Œë¦¼
      if (should_alert) {
        await sendAlertToTeacher(total_count);
        await supabase.rpc('update_mindtalk_alert_sent', {
          student_id_input: studentId
        });
      }
    }
  }
  
  // ... ìƒëµ ...
}, [/* dependencies */]);
```

### 3.4 ë‹´ì„ì„ ìƒë‹˜ì—ê²Œ ì•Œë¦¼ ë³´ë‚´ê¸°

```tsx
const sendAlertToTeacher = async (totalCount: number) => {
  try {
    await supabase.functions.invoke('mindtalk-alert', {
      body: {
        studentId,
        studentName,
        studentGrade,
        studentClass,
        studentNumber,
        dangerousWordCount: totalCount
      }
    });
    console.log('Alert sent to homeroom teacher');
  } catch (error) {
    console.error('Failed to send alert:', error);
  }
};
```

#### supabase.functions.invoke ì´í•´í•˜ê¸°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  supabase.functions.invoke('í•¨ìˆ˜ì´ë¦„', { body: ë°ì´í„° })      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  í”„ë¡ íŠ¸ì—”ë“œ (ë¸Œë¼ìš°ì €)                                        â”‚
â”‚       â”‚                                                     â”‚
â”‚       â”‚  invoke('mindtalk-alert', { body: {...} })          â”‚
â”‚       â”‚                                                     â”‚
â”‚       â–¼                                                     â”‚
â”‚  Edge Function (ì„œë²„)                                        â”‚
â”‚       â”‚                                                     â”‚
â”‚       â”‚  ë°ì´í„° ì²˜ë¦¬ + ì´ë©”ì¼ ë°œì†¡                            â”‚
â”‚       â”‚                                                     â”‚
â”‚       â–¼                                                     â”‚
â”‚  ê²°ê³¼ ë°˜í™˜                                                   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. Edge Function ì½”ë“œ ë¶„ì„

íŒŒì¼ ìœ„ì¹˜: `supabase/functions/mindtalk-alert/index.ts`

### 4.1 ê¸°ë³¸ êµ¬ì¡°

```tsx
import { serve } from "https://deno.land/std@0.168.0/http/server.ts";
import { createClient } from "https://esm.sh/@supabase/supabase-js@2";
import { Resend } from "https://esm.sh/resend@2.0.0";

// CORS ì„¤ì • (ë‹¤ë¥¸ ë„ë©”ì¸ì—ì„œ ì ‘ê·¼ í—ˆìš©)
const corsHeaders = {
  'Access-Control-Allow-Origin': '*',
  'Access-Control-Allow-Headers': 'authorization, x-client-info, apikey, content-type',
};

// ìš”ì²­ ë°ì´í„° íƒ€ì… ì •ì˜
interface AlertRequest {
  studentId: string;
  studentName: string;
  studentGrade: number;
  studentClass: number;
  studentNumber: number;
  dangerousWordCount: number;
}

serve(async (req) => {
  // ... ì²˜ë¦¬ ë¡œì§
});
```

### 4.2 ìš”ì²­ ë°ì´í„° ì¶”ì¶œ

```tsx
serve(async (req) => {
  // OPTIONS ìš”ì²­ ì²˜ë¦¬ (CORS preflight)
  if (req.method === 'OPTIONS') {
    return new Response(null, { headers: corsHeaders });
  }

  try {
    // ìš”ì²­ ë³¸ë¬¸ì—ì„œ ë°ì´í„° ì¶”ì¶œ
    const { 
      studentId, 
      studentName, 
      studentGrade, 
      studentClass, 
      studentNumber,
      dangerousWordCount 
    }: AlertRequest = await req.json();

    console.log(`ğŸš¨ MindTalk Alert: ${studentName} (${studentId}) - ${dangerousWordCount} dangerous words`);
```

#### req.json() ì´í•´í•˜ê¸°

```
í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ë³´ë‚¸ ë°ì´í„°:
{
  studentId: "10101",
  studentName: "ê¹€ë¯¼ìˆ˜",
  studentGrade: 1,
  studentClass: 1,
  studentNumber: 1,
  dangerousWordCount: 3
}

await req.json()
â†’ ìœ„ JSON ë°ì´í„°ë¥¼ JavaScript ê°ì²´ë¡œ ë³€í™˜

const { studentId, studentName, ... } = await req.json()
â†’ ê°ì²´ì—ì„œ í•„ìš”í•œ ê°’ë“¤ì„ ê°ê° ë³€ìˆ˜ë¡œ ì¶”ì¶œ (êµ¬ì¡°ë¶„í•´í• ë‹¹)
```

### 4.3 ë‹´ì„ì„ ìƒë‹˜ ì°¾ê¸°

```tsx
// í™˜ê²½ë³€ìˆ˜ì—ì„œ ì„¤ì • ê°€ì ¸ì˜¤ê¸°
const supabaseUrl = Deno.env.get("SUPABASE_URL")!;
const supabaseServiceKey = Deno.env.get("SUPABASE_SERVICE_ROLE_KEY")!;

// Supabase í´ë¼ì´ì–¸íŠ¸ ìƒì„±
const supabase = createClient(supabaseUrl, supabaseServiceKey);

// ë‹´ì„ì„ ìƒë‹˜ ì¡°íšŒ
const { data: teacher, error: teacherError } = await supabase
  .from('teachers')                    // teachers í…Œì´ë¸”ì—ì„œ
  .select('id, name, teacher_email')   // ì´ ì»¬ëŸ¼ë“¤ì„ ì„ íƒ
  .eq('grade', studentGrade)           // í•™ë…„ ì¼ì¹˜
  .eq('class', studentClass)           // ë°˜ ì¼ì¹˜
  .eq('is_homeroom', true)             // ë‹´ì„ì„ ìƒë‹˜ì¸ì§€
  .single();                           // ê²°ê³¼ 1ê°œë§Œ

if (teacherError || !teacher) {
  console.log(`No homeroom teacher found for grade ${studentGrade} class ${studentClass}`);
  return new Response(JSON.stringify({ 
    success: false, 
    message: "ë‹´ì„ì„ ìƒë‹˜ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤." 
  }), {
    headers: { ...corsHeaders, "Content-Type": "application/json" },
  });
}
```

#### Supabase ì¿¼ë¦¬ ì´í•´í•˜ê¸°

```
SQLë¡œ í‘œí˜„í•˜ë©´:

SELECT id, name, teacher_email
FROM teachers
WHERE grade = 1
  AND class = 1
  AND is_homeroom = true
LIMIT 1;

Supabase ë°©ì‹:

supabase
  .from('teachers')
  .select('id, name, teacher_email')
  .eq('grade', 1)
  .eq('class', 1)
  .eq('is_homeroom', true)
  .single();
```

### 4.4 ì´ë©”ì¼ ë°œì†¡

```tsx
// Resend APIë¡œ ì´ë©”ì¼ ë°œì†¡
const resend = new Resend(resendApiKey);

const { data: emailResult, error: emailError } = await resend.emails.send({
  from: "ìŠ¤ì¿¨í¬ì¸íŠ¸ ë§ˆìŒí†¡ <noreply@schoolpoint.store>",
  to: [teacher.teacher_email],           // ë‹´ì„ì„ ìƒë‹˜ ì´ë©”ì¼
  reply_to: replyToEmail,                 // ë‹µì¥ ë°›ì„ ì´ë©”ì¼
  subject: `ğŸš¨ [ê¸´ê¸‰] ${studentName} í•™ìƒ ë§ˆìŒí†¡ ìœ„í—˜ ì‹ í˜¸ ê°ì§€`,
  html: emailHtml,                        // HTML í˜•ì‹ ì´ë©”ì¼ ë‚´ìš©
});

if (emailError) {
  console.error("Email send error:", emailError);
  throw emailError;
}

console.log(`âœ… Alert email sent to ${teacher.name} (${teacher.teacher_email})`);
```

---

## 5. ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡°

### 5.1 mindtalk_alerts í…Œì´ë¸”

```sql
CREATE TABLE mindtalk_alerts (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  student_id TEXT UNIQUE NOT NULL,      -- í•™ë²ˆ (ì¤‘ë³µ ë¶ˆê°€)
  dangerous_word_count INTEGER DEFAULT 0, -- ìœ„í—˜ ë‹¨ì–´ ëˆ„ì  íšŸìˆ˜
  last_alert_sent_at TIMESTAMP,         -- ë§ˆì§€ë§‰ ì•Œë¦¼ ë°œì†¡ ì‹œê°„
  last_alert_count INTEGER DEFAULT 0,   -- ë§ˆì§€ë§‰ ì•Œë¦¼ ë•Œ íšŸìˆ˜
  created_at TIMESTAMP DEFAULT now(),
  updated_at TIMESTAMP DEFAULT now()
);
```

#### í…Œì´ë¸” êµ¬ì¡° ì‹œê°í™”

```
mindtalk_alerts í…Œì´ë¸”
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id       â”‚ student_id â”‚ dangerous â”‚ last_alert â”‚ last_alert â”‚   â”‚
â”‚ (UUID)   â”‚ (TEXT)     â”‚ _word_cnt â”‚ _sent_at   â”‚ _count     â”‚   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¤
â”‚ abc-123  â”‚ 10101      â”‚ 5         â”‚ 2024-12-16 â”‚ 3          â”‚   â”‚
â”‚ def-456  â”‚ 10205      â”‚ 2         â”‚ NULL       â”‚ 0          â”‚   â”‚
â”‚ ghi-789  â”‚ 20301      â”‚ 6         â”‚ 2024-12-15 â”‚ 6          â”‚   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”˜
```

### 5.2 ê´€ë ¨ RPC í•¨ìˆ˜

#### update_mindtalk_danger_count

```sql
CREATE FUNCTION update_mindtalk_danger_count(
  student_id_input TEXT, 
  increment_by INTEGER DEFAULT 1
)
RETURNS TABLE(
  total_count INTEGER, 
  should_alert BOOLEAN, 
  last_alert_count INTEGER
)
AS $$
DECLARE
  current_count INTEGER;
  current_last_alert INTEGER;
BEGIN
  -- ë ˆì½”ë“œê°€ ì—†ìœ¼ë©´ ìƒì„±, ìˆìœ¼ë©´ ì—…ë°ì´íŠ¸ (UPSERT)
  INSERT INTO mindtalk_alerts (student_id, dangerous_word_count, last_alert_count)
  VALUES (student_id_input, increment_by, 0)
  ON CONFLICT (student_id) DO UPDATE
  SET dangerous_word_count = mindtalk_alerts.dangerous_word_count + increment_by,
      updated_at = now()
  RETURNING mindtalk_alerts.dangerous_word_count, mindtalk_alerts.last_alert_count
  INTO current_count, current_last_alert;
  
  -- ì•Œë¦¼ ì¡°ê±´ í™•ì¸: ì´ 3íšŒ ì´ìƒì´ê³ , ë§ˆì§€ë§‰ ì•Œë¦¼ ì´í›„ 3íšŒ ì´ìƒ
  RETURN QUERY
  SELECT 
    current_count,
    (current_count >= 3 AND current_count - current_last_alert >= 3)::BOOLEAN,
    current_last_alert;
END;
$$ LANGUAGE plpgsql;
```

#### ğŸ’¡ UPSERTë€?

```
UPSERT = UPDATE + INSERT

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ë°ì´í„°ê°€ ì—†ìœ¼ë©´ â†’ INSERT (ìƒˆë¡œ ì¶”ê°€)                         â”‚
â”‚  ë°ì´í„°ê°€ ìˆìœ¼ë©´ â†’ UPDATE (ê¸°ì¡´ ë°ì´í„° ìˆ˜ì •)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

INSERT INTO mindtalk_alerts (student_id, dangerous_word_count)
VALUES ('10101', 1)
ON CONFLICT (student_id) DO UPDATE  â† student_idê°€ ì´ë¯¸ ìˆìœ¼ë©´
SET dangerous_word_count = mindtalk_alerts.dangerous_word_count + 1;
```

---

## 6. ì´ë©”ì¼ í…œí”Œë¦¿ ë””ìì¸

### 6.1 HTML ì´ë©”ì¼ êµ¬ì¡°

```html
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <style>
    /* ìŠ¤íƒ€ì¼ ì •ì˜ */
  </style>
</head>
<body>
  <div class="container">
    <!-- í—¤ë” (ë¹¨ê°„ìƒ‰ ë°°ê²½) -->
    <div class="header">
      <h1>ğŸš¨ ë§ˆìŒí†¡ ìœ„í—˜ ì‹ í˜¸ ê°ì§€</h1>
    </div>
    
    <!-- ë‚´ìš© -->
    <div class="content">
      <!-- ê²½ê³  ë°•ìŠ¤ -->
      <div class="alert-box">
        <p>âš ï¸ í•™ìƒì˜ ëŒ€í™”ì—ì„œ ìœ„í—˜ ì‹ í˜¸ê°€ ê°ì§€ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
      </div>
      
      <!-- í•™ìƒ ì •ë³´ -->
      <div class="student-info">
        <h3>ğŸ“‹ í•™ìƒ ì •ë³´</h3>
        <!-- ì´ë¦„, í•™ë…„, ë°˜, ë²ˆí˜¸ ë“± -->
      </div>
      
      <!-- ê¶Œì¥ ì¡°ì¹˜ -->
      <ul>
        <li>í•™ìƒê³¼ 1:1 ë©´ë‹´ì„ ì§„í–‰í•´ ì£¼ì„¸ìš”</li>
        <li>í•„ìš”ì‹œ ì „ë¬¸ ìƒë‹´ êµì‚¬ì—ê²Œ ì—°ê³„í•´ ì£¼ì„¸ìš”</li>
      </ul>
    </div>
    
    <!-- í‘¸í„° -->
    <div class="footer">
      <p>ìŠ¤ì¿¨í¬ì¸íŠ¸ ë§ˆìŒí†¡ ì‹œìŠ¤í…œ</p>
    </div>
  </div>
</body>
</html>
```

### 6.2 ìŠ¤íƒ€ì¼ ì„¤ëª…

```css
/* ì „ì²´ ë°°ê²½ */
body { 
  background: #f8f9fa;  /* ë°ì€ íšŒìƒ‰ */
  padding: 20px; 
}

/* ì»¨í…Œì´ë„ˆ ì¹´ë“œ */
.container { 
  max-width: 600px;      /* ìµœëŒ€ ë„ˆë¹„ 600px */
  background: white;
  border-radius: 12px;   /* ë‘¥ê·¼ ëª¨ì„œë¦¬ */
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);  /* ê·¸ë¦¼ì */
}

/* í—¤ë” (ìœ„í—˜ - ë¹¨ê°„ìƒ‰) */
.header { 
  background: linear-gradient(135deg, #ef4444, #dc2626);  /* ë¹¨ê°„ ê·¸ë¼ë°ì´ì…˜ */
  color: white;
  padding: 24px;
}

/* ê²½ê³  ë°•ìŠ¤ */
.alert-box { 
  background: #fef2f2;  /* ì—°í•œ ë¹¨ê°„ìƒ‰ ë°°ê²½ */
  border: 1px solid #fecaca;
  border-radius: 8px;
}

/* í•™ìƒ ì •ë³´ ë°•ìŠ¤ */
.student-info { 
  background: #f1f5f9;  /* ì—°í•œ íšŒìƒ‰ ë°°ê²½ */
  border-radius: 8px;
}
```

### 6.3 ì´ë©”ì¼ ë¯¸ë¦¬ë³´ê¸°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸš¨ ë§ˆìŒí†¡ ìœ„í—˜ ì‹ í˜¸ ê°ì§€                          [ë¹¨ê°„ë°°ê²½] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ âš ï¸ í•™ìƒì˜ ëŒ€í™”ì—ì„œ ìœ„í—˜ ì‹ í˜¸ê°€ ê°ì§€ë˜ì—ˆìŠµë‹ˆë‹¤.          â”‚  â”‚
â”‚  â”‚ ë§ˆìŒí†¡ AI ìƒë‹´ ì¤‘ ìœ„í—˜í•œ ë‹¨ì–´ê°€ 5íšŒ ëˆ„ì  ê°ì§€ë˜ì—ˆìŠµë‹ˆë‹¤.  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ“‹ í•™ìƒ ì •ë³´                                          â”‚  â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  â”‚
â”‚  â”‚ ì´ë¦„     â”‚ ê¹€ë¯¼ìˆ˜                                     â”‚  â”‚
â”‚  â”‚ í•™ë…„     â”‚ 1í•™ë…„                                      â”‚  â”‚
â”‚  â”‚ ë°˜       â”‚ 1ë°˜                                        â”‚  â”‚
â”‚  â”‚ ë²ˆí˜¸     â”‚ 1ë²ˆ                                        â”‚  â”‚
â”‚  â”‚ í•™ë²ˆ     â”‚ 10101                                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â”‚  ê¶Œì¥ ì¡°ì¹˜:                                                  â”‚
â”‚  â€¢ í•™ìƒê³¼ 1:1 ë©´ë‹´ì„ ì§„í–‰í•´ ì£¼ì„¸ìš”                           â”‚
â”‚  â€¢ í•„ìš”ì‹œ ì „ë¬¸ ìƒë‹´ êµì‚¬ì—ê²Œ ì—°ê³„í•´ ì£¼ì„¸ìš”                    â”‚
â”‚  â€¢ í•™ë¶€ëª¨ì™€ì˜ ì†Œí†µì„ ê³ ë ¤í•´ ì£¼ì„¸ìš”                           â”‚
â”‚                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              ìŠ¤ì¿¨í¬ì¸íŠ¸ ë§ˆìŒí†¡ ì‹œìŠ¤í…œ               [íšŒìƒ‰ë°°ê²½] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 7. ë³´ì•ˆ ë° ê°œì¸ì •ë³´ ë³´í˜¸

### 7.1 ë¯¼ê°í•œ ì •ë³´ ë³´í˜¸

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ë³´ì•ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  âœ… API í‚¤ ë³´í˜¸                                              â”‚
â”‚     - RESEND_API_KEYëŠ” í™˜ê²½ë³€ìˆ˜ë¡œë§Œ ì €ì¥                     â”‚
â”‚     - ì½”ë“œì— ì§ì ‘ ì‘ì„±í•˜ì§€ ì•ŠìŒ                              â”‚
â”‚                                                             â”‚
â”‚  âœ… ì„œë²„ ì¸¡ ì²˜ë¦¬                                             â”‚
â”‚     - ì´ë©”ì¼ ë°œì†¡ì€ Edge Functionì—ì„œë§Œ                      â”‚
â”‚     - í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ì§ì ‘ API í˜¸ì¶œ ë¶ˆê°€                      â”‚
â”‚                                                             â”‚
â”‚  âœ… ë°ì´í„° ì ‘ê·¼ ì œí•œ                                         â”‚
â”‚     - í•™ìƒì€ ìì‹ ì˜ ë°ì´í„°ë§Œ ì ‘ê·¼                            â”‚
â”‚     - ë‹´ì„ì„ ìƒë‹˜ë§Œ ì•Œë¦¼ ìˆ˜ì‹                                  â”‚
â”‚                                                             â”‚
â”‚  âœ… ì•Œë¦¼ ì£¼ê¸° ì œí•œ                                           â”‚
â”‚     - 3íšŒë§ˆë‹¤ ì•Œë¦¼ (ê³¼ë„í•œ ì•Œë¦¼ ë°©ì§€)                        â”‚
â”‚     - ë‹´ì„ì„ ìƒë‹˜ì˜ í”¼ë¡œë„ ê³ ë ¤                               â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 ê°œì¸ì •ë³´ ì²˜ë¦¬ ì›ì¹™

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 ê°œì¸ì •ë³´ ì²˜ë¦¬ ì›ì¹™                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  1. ìµœì†Œ ìˆ˜ì§‘                                                â”‚
â”‚     - ì•Œë¦¼ì— í•„ìš”í•œ ì •ë³´ë§Œ ìˆ˜ì§‘                              â”‚
â”‚     - ëŒ€í™” ë‚´ìš© ìì²´ëŠ” ì•Œë¦¼ì— í¬í•¨í•˜ì§€ ì•ŠìŒ                   â”‚
â”‚                                                             â”‚
â”‚  2. ëª©ì  ì œí•œ                                                â”‚
â”‚     - í•™ìƒ ì•ˆì „ ëª©ì ìœ¼ë¡œë§Œ ì‚¬ìš©                              â”‚
â”‚     - ë‹¤ë¥¸ ìš©ë„ë¡œ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ                              â”‚
â”‚                                                             â”‚
â”‚  3. ì ‘ê·¼ ì œí•œ                                                â”‚
â”‚     - ë‹´ì„ì„ ìƒë‹˜ë§Œ ì•Œë¦¼ ìˆ˜ì‹                                  â”‚
â”‚     - ê´€ë¦¬ìëŠ” í†µê³„ë§Œ ì¡°íšŒ ê°€ëŠ¥                              â”‚
â”‚                                                             â”‚
â”‚  4. ë¡œê·¸ ê¸°ë¡                                                â”‚
â”‚     - ì•Œë¦¼ ë°œì†¡ ê¸°ë¡ ì €ì¥                                    â”‚
â”‚     - ì¶”í›„ ê²€í† ë¥¼ ìœ„í•œ ê°ì‚¬ ì¶”ì                              â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 8. ì‹¤ìŠµ ê³¼ì œ

### ê³¼ì œ 1: ìƒˆë¡œìš´ ìœ„í—˜ ë‹¨ì–´ ì¶”ê°€í•˜ê¸°

DANGEROUS_WORDS ë°°ì—´ì— ìƒˆë¡œìš´ ìœ„í—˜ ë‹¨ì–´ë¥¼ ì¶”ê°€í•´ë³´ì„¸ìš”.

```tsx
const DANGEROUS_WORDS = [
  // ê¸°ì¡´ ë‹¨ì–´ë“¤...
  
  // ìƒˆë¡œ ì¶”ê°€í•  ë‹¨ì–´ë“¤ (ì˜ˆì‹œ)
  'í¬ê¸°í•˜ê³  ì‹¶ì–´',
  'ë„ë§ê°€ê³  ì‹¶ì–´',
  'ëª¨ë“  ê²Œ ì‹«ì–´'
];
```

### ê³¼ì œ 2: ì•Œë¦¼ ì¡°ê±´ ë³€ê²½í•˜ê¸°

í˜„ì¬ 3íšŒë§ˆë‹¤ ì•Œë¦¼ì´ ë°œì†¡ë©ë‹ˆë‹¤. ì´ë¥¼ 5íšŒë¡œ ë³€ê²½í•´ë³´ì„¸ìš”.

```sql
-- update_mindtalk_danger_count í•¨ìˆ˜ì—ì„œ
-- ê¸°ì¡´: current_count >= 3 AND current_count - current_last_alert >= 3
-- ë³€ê²½: current_count >= 5 AND current_count - current_last_alert >= 5

RETURN QUERY
SELECT 
  current_count,
  (current_count >= 5 AND current_count - current_last_alert >= 5)::BOOLEAN,
  current_last_alert;
```

### ê³¼ì œ 3: ì´ë©”ì¼ í…œí”Œë¦¿ ìƒ‰ìƒ ë³€ê²½í•˜ê¸°

í—¤ë”ì˜ ë¹¨ê°„ìƒ‰ì„ ë‹¤ë¥¸ ìƒ‰ìƒìœ¼ë¡œ ë³€ê²½í•´ë³´ì„¸ìš”.

```css
/* ê¸°ì¡´ (ë¹¨ê°„ìƒ‰) */
.header { 
  background: linear-gradient(135deg, #ef4444, #dc2626);
}

/* ë³€ê²½ (ì£¼í™©ìƒ‰) */
.header { 
  background: linear-gradient(135deg, #f97316, #ea580c);
}

/* ë³€ê²½ (ë³´ë¼ìƒ‰) */
.header { 
  background: linear-gradient(135deg, #8b5cf6, #7c3aed);
}
```

### ê³¼ì œ 4: ì•Œë¦¼ì— ì¶”ê°€ ì •ë³´ í¬í•¨í•˜ê¸°

ì´ë©”ì¼ì— ë§ˆì§€ë§‰ ì ‘ì† ì‹œê°„ì„ ì¶”ê°€í•´ë³´ì„¸ìš”.

```tsx
// AlertRequest ì¸í„°í˜ì´ìŠ¤ì— ì¶”ê°€
interface AlertRequest {
  // ê¸°ì¡´ í•„ë“œë“¤...
  lastAccessTime?: string;  // ìƒˆë¡œ ì¶”ê°€
}

// ì´ë©”ì¼ í…œí”Œë¦¿ì— ì¶”ê°€
<div class="info-row">
  <span class="label">ë§ˆì§€ë§‰ ì ‘ì†</span>
  <span class="value">${lastAccessTime || 'ì•Œ ìˆ˜ ì—†ìŒ'}</span>
</div>
```

---

## ğŸ“ ìš©ì–´ ì •ë¦¬

| ìš©ì–´ | ì„¤ëª… |
|------|------|
| **Edge Function** | ì„œë²„ì—ì„œ ì‹¤í–‰ë˜ëŠ” í•¨ìˆ˜ (Supabaseì—ì„œ ì œê³µ) |
| **CORS** | ë‹¤ë¥¸ ë„ë©”ì¸ ê°„ì˜ í†µì‹ ì„ í—ˆìš©í•˜ëŠ” ì„¤ì • |
| **RPC** | Remote Procedure Call, ì›ê²© í•¨ìˆ˜ í˜¸ì¶œ |
| **UPSERT** | INSERT + UPDATE, ì—†ìœ¼ë©´ ì¶”ê°€í•˜ê³  ìˆìœ¼ë©´ ìˆ˜ì • |
| **í™˜ê²½ë³€ìˆ˜** | ì„œë²„ì— ì €ì¥ëœ ë¹„ë°€ ì„¤ì •ê°’ (API í‚¤ ë“±) |
| **Resend** | ì´ë©”ì¼ ë°œì†¡ ì„œë¹„ìŠ¤ |
| **HTML ì´ë©”ì¼** | ìŠ¤íƒ€ì¼ì´ ì ìš©ëœ ì´ë©”ì¼ í˜•ì‹ |

---

## ğŸ‰ ë§ˆë¬´ë¦¬

ì¶•í•˜í•©ë‹ˆë‹¤! MindTalk ìœ„í—˜ ì•Œë¦¼ ì‹œìŠ¤í…œì˜ ì „ì²´ êµ¬ì¡°ë¥¼ ì´í•´í–ˆìŠµë‹ˆë‹¤.

### ë°°ìš´ ë‚´ìš© ì •ë¦¬

1. âœ… ìœ„í—˜ ë‹¨ì–´ ê°ì§€ ë¡œì§
2. âœ… ëˆ„ì  ì¹´ìš´íŠ¸ ê´€ë¦¬
3. âœ… ì•Œë¦¼ ë°œì†¡ ì¡°ê±´
4. âœ… Edge Function êµ¬ì¡°
5. âœ… ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„
6. âœ… HTML ì´ë©”ì¼ í…œí”Œë¦¿
7. âœ… ë³´ì•ˆ ë° ê°œì¸ì •ë³´ ë³´í˜¸

### ì‹œìŠ¤í…œì˜ ì˜ë¯¸

ì´ ì‹œìŠ¤í…œì€ í•™ìƒë“¤ì˜ ì•ˆì „ì„ ìœ„í•´ ë§Œë“¤ì–´ì¡ŒìŠµë‹ˆë‹¤. ê¸°ìˆ ì€ ì‚¬ëŒì„ ë•ê¸° ìœ„í•´ ì¡´ì¬í•˜ë©°, ì´ ì‹œìŠ¤í…œì´ í˜ë“  í•™ìƒë“¤ì„ ì¡°ê¸°ì— ë°œê²¬í•˜ê³  ë„ì›€ì„ ì¤„ ìˆ˜ ìˆëŠ” ê³„ê¸°ê°€ ë˜ê¸°ë¥¼ ë°”ëë‹ˆë‹¤.

---

*ì´ ë¬¸ì„œëŠ” 2024ë…„ 12ì›”ì— ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.*
*ì§ˆë¬¸ì´ ìˆìœ¼ë©´ ì–¸ì œë“  ë¬¼ì–´ë³´ì„¸ìš”! ğŸ™‹â€â™‚ï¸*
