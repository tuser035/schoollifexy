# 🧑‍🏫 교사 테이블 삭제 & CSV 가져오기 가이드

> 중학생도 따라할 수 있는 교사 데이터 관리 가이드입니다.

---

## 📋 목차

1. [시작하기 전에](#시작하기-전에)
2. [교사 CSV 파일 준비하기](#1단계-교사-csv-파일-준비하기)
3. [시스템 관리자 로그인하기](#2단계-시스템-관리자-로그인하기)
4. [기존 교사 데이터 삭제하기](#3단계-기존-교사-데이터-삭제하기)
5. [새 교사 데이터 가져오기](#4단계-새-교사-데이터-가져오기)
6. [결과 확인하기](#5단계-결과-확인하기)
7. [자주 묻는 질문](#자주-묻는-질문)

---

## 시작하기 전에

### ⚠️ 주의사항
- **삭제하면 복구 불가능!** 기존 데이터는 완전히 삭제됩니다
- 삭제 전에 반드시 **백업**을 먼저 하세요
- **시스템 관리자 계정**으로만 이 작업을 할 수 있습니다

### 🛠️ 필요한 것
- 시스템 관리자 계정 (이메일/비밀번호)
- 교사 정보가 담긴 CSV 파일

---

## 1단계: 교사 CSV 파일 준비하기

### CSV 파일이란?
- **C**omma **S**eparated **V**alues의 약자
- 쉼표(,)로 데이터를 구분하는 파일
- 엑셀에서 쉽게 만들 수 있어요!

### CSV 파일 형식

```csv
teacher_email,name,call_t,grade,class,department,subject,is_homeroom,is_admin
kim@school.kr,김선생,010-1234-5678,1,1,수학과,수학,true,false
lee@school.kr,이선생,010-2345-6789,1,2,영어과,영어,true,false
park@school.kr,박선생,010-3456-7890,2,1,국어과,국어,true,true
```

### 각 열(Column) 설명

| 열 이름 | 뜻 | 예시 | 필수 여부 |
|---------|-----|------|-----------|
| `teacher_email` | 교사 이메일 | kim@school.kr | ✅ 필수 |
| `name` | 교사 이름 | 김선생 | ✅ 필수 |
| `call_t` | 전화번호 | 010-1234-5678 | ✅ 필수 |
| `grade` | 담당 학년 | 1 | 선택 |
| `class` | 담당 반 | 1 | 선택 |
| `department` | 소속 부서 | 수학과 | 선택 |
| `subject` | 담당 과목 | 수학 | 선택 |
| `is_homeroom` | 담임 여부 | true/false | 선택 |
| `is_admin` | 관리자 권한 | true/false | 선택 |
| `dept_code` | 학과 코드 | IT | 선택 |
| `photo_url` | 사진 URL | https://... | 선택 |

### 엑셀에서 CSV 파일 만들기

1. **엑셀 열기** → 새 파일 만들기
2. **첫 번째 행**에 열 이름 입력:
   ```
   A1: teacher_email
   B1: name
   C1: call_t
   D1: grade
   E1: class
   F1: department
   G1: subject
   H1: is_homeroom
   I1: is_admin
   ```
3. **두 번째 행부터** 교사 정보 입력
4. **파일 → 다른 이름으로 저장** 클릭
5. 파일 형식을 **CSV UTF-8 (쉼표로 분리)** 선택
6. **저장** 클릭

### 예시 CSV 파일 내용

```csv
teacher_email,name,call_t,grade,class,department,subject,is_homeroom,is_admin
hong@school.kr,홍길동,010-1111-2222,1,1,수학과,수학,true,false
kim@school.kr,김영희,010-3333-4444,1,2,영어과,영어,true,false
lee@school.kr,이철수,010-5555-6666,2,1,국어과,국어,false,false
park@school.kr,박관리,010-7777-8888,,,교무실,생활지도,false,true
```

---

## 2단계: 시스템 관리자 로그인하기

### 로그인 방법

1. 웹사이트 메인 페이지로 이동
2. **"시스템 관리자"** 탭 클릭
3. 이메일과 비밀번호 입력
4. **"시스템 관리자 로그인"** 버튼 클릭

```
┌─────────────────────────────────────┐
│         시스템 관리자 로그인          │
├─────────────────────────────────────┤
│  이메일: [________________]         │
│  비밀번호: [________________]       │
│                                     │
│  [   시스템 관리자 로그인   ]        │
└─────────────────────────────────────┘
```

### 로그인 성공 확인
- 화면 왼쪽에 **사이드바 메뉴**가 나타납니다
- 상단에 **관리자 이름**이 표시됩니다

---

## 3단계: 기존 교사 데이터 삭제하기

### ⚠️ 중요! 삭제 전 백업하기

1. 왼쪽 메뉴에서 **"데이터 내보내기"** 클릭
2. **"전체 데이터 백업"** 버튼 클릭
3. ZIP 파일이 다운로드됩니다 → 안전한 곳에 보관!

### 삭제 방법

1. **왼쪽 메뉴**에서 **"테이블 데이터 삭제"** 클릭 (또는 "CSV 업로드" 메뉴)

2. **"전체 데이터 삭제"** 섹션을 찾습니다

3. **드롭다운 메뉴** 클릭 → **"교사"** 선택

```
┌─────────────────────────────────────┐
│       ⚠️ 전체 데이터 삭제            │
├─────────────────────────────────────┤
│  삭제할 테이블 선택:                  │
│  ┌────────────────────────┐         │
│  │ 교사                 ▼ │         │
│  └────────────────────────┘         │
│                                     │
│  [ 🗑️ 선택한 테이블 데이터 삭제 ]    │
└─────────────────────────────────────┘
```

4. **"선택한 테이블 데이터 삭제"** 버튼 클릭

5. **확인 팝업**이 나타납니다:
   - ⚠️ "정말로 교사 테이블의 모든 데이터를 삭제하시겠습니까?"
   - **"삭제"** 버튼 클릭

6. **삭제 완료 메시지** 확인:
   - ✅ "교사 테이블의 N개 데이터가 삭제되었습니다"

### 삭제 과정 내부 동작 (참고)

```javascript
// 시스템 내부에서 이렇게 동작해요
const { data, error } = await supabase.rpc("admin_delete_all_from_table", {
  admin_id_input: "관리자ID",
  table_name_input: "teachers"  // 교사 테이블 지정
});
```

---

## 4단계: 새 교사 데이터 가져오기

### CSV 파일 업로드 방법

1. 같은 화면에서 **"교사"** 카드를 찾습니다
   - 파란색 테두리가 있는 카드입니다

```
┌─────────────────────────────────────┐
│  🧑‍🏫 교사                           │
│  ─────────────────────────────────  │
│  teacher_email, name, call_t,       │
│  grade, class, dept_code, ...       │
│                                     │
│  [ 📤 CSV 파일 선택 ]               │
└─────────────────────────────────────┘
```

2. **"CSV 파일 선택"** 버튼 클릭

3. 컴퓨터에서 **준비한 CSV 파일** 선택

4. **업로드 진행** (버튼이 "업로드 중..."으로 변함)

5. **완료 메시지** 확인:
   - ✅ "교사 N개 데이터가 업로드되었습니다"

### 업로드 과정 내부 동작 (참고)

```javascript
// 각 교사 정보를 하나씩 저장해요
for (const record of 교사목록) {
  await supabase.rpc('admin_insert_teacher', {
    admin_id_input: "관리자ID",
    name_input: record.name,           // 이름
    call_t_input: record.call_t,       // 전화번호
    teacher_email_input: record.teacher_email,  // 이메일
    grade_input: record.grade,         // 학년
    class_input: record.class,         // 반
    is_homeroom_input: record.is_homeroom,  // 담임 여부
    is_admin_input: record.is_admin,   // 관리자 권한
    department_input: record.department,  // 부서
    subject_input: record.subject      // 과목
  });
}
```

---

## 5단계: 결과 확인하기

### 데이터 조회 방법

1. 왼쪽 메뉴에서 **"데이터 조회"** 클릭

2. 상단 탭에서 **"교사"** 클릭

3. 업로드된 교사 목록이 표시됩니다

```
┌────────────────────────────────────────────────────────┐
│ 이름    │ 전화번호      │ 이메일         │ 학년 │ 반  │
├────────────────────────────────────────────────────────┤
│ 홍길동  │ 010-1111-2222 │ hong@school.kr │ 1    │ 1   │
│ 김영희  │ 010-3333-4444 │ kim@school.kr  │ 1    │ 2   │
│ 이철수  │ 010-5555-6666 │ lee@school.kr  │ 2    │ 1   │
│ 박관리  │ 010-7777-8888 │ park@school.kr │ -    │ -   │
└────────────────────────────────────────────────────────┘
```

### 검색으로 확인하기

- **검색창**에 교사 이름 입력
- **학년/반 필터**로 특정 교사 찾기

---

## 🔄 전체 작업 흐름 요약

```
┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│  1. CSV     │ ──▶ │  2. 로그인   │ ──▶ │  3. 백업    │
│  파일 준비   │     │  (관리자)   │     │  (안전!)    │
└─────────────┘     └─────────────┘     └─────────────┘
                                              │
                                              ▼
┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│  6. 확인    │ ◀── │  5. CSV     │ ◀── │  4. 삭제    │
│  (데이터조회)│     │  업로드     │     │  (교사)     │
└─────────────┘     └─────────────┘     └─────────────┘
```

---

## 자주 묻는 질문

### ❓ Q1: CSV 파일에 한글이 깨져요
**A:** 파일 저장할 때 **"CSV UTF-8 (쉼표로 분리)"** 형식으로 저장하세요!

### ❓ Q2: 업로드 중 오류가 나요
**A:** 다음을 확인하세요:
- `teacher_email`, `name`, `call_t`는 **필수 항목**입니다
- 이메일 형식이 올바른지 확인 (예: abc@school.kr)
- 전화번호 형식 확인 (예: 010-1234-5678)

### ❓ Q3: 이미 있는 교사가 중복으로 들어가나요?
**A:** 아니요! `teacher_email`이 같으면 **자동으로 정보가 업데이트**됩니다.

### ❓ Q4: 특정 교사만 수정하고 싶어요
**A:** "데이터 조회" → "교사" → 교사 선택 → "수정" 버튼을 사용하세요.

### ❓ Q5: 삭제한 데이터를 복구할 수 있나요?
**A:** 백업해두었다면 "데이터 내보내기" 메뉴에서 **"백업 복원"** 기능을 사용하세요.

### ❓ Q6: is_homeroom, is_admin 값은 어떻게 쓰나요?
**A:** 
- `true` = 예 (담임이다 / 관리자다)
- `false` = 아니오 (담임 아니다 / 관리자 아니다)

---

## 📝 실습해보기

### 연습 문제

**다음 교사 정보를 CSV로 만들어 업로드해보세요:**

| 이름 | 이메일 | 전화번호 | 학년 | 반 | 과목 | 담임 |
|------|--------|----------|------|-----|------|------|
| 테스트선생 | test@school.kr | 010-0000-0000 | 1 | 1 | 테스트 | 예 |

**정답 CSV:**
```csv
teacher_email,name,call_t,grade,class,department,subject,is_homeroom,is_admin
test@school.kr,테스트선생,010-0000-0000,1,1,테스트과,테스트,true,false
```

---

## 🎯 핵심 정리

| 단계 | 할 일 | 주의사항 |
|------|-------|----------|
| 1️⃣ | CSV 파일 준비 | UTF-8 인코딩 필수! |
| 2️⃣ | 관리자 로그인 | 시스템 관리자만 가능 |
| 3️⃣ | 백업 먼저! | 삭제 전 필수 |
| 4️⃣ | 교사 테이블 삭제 | 되돌릴 수 없음 |
| 5️⃣ | CSV 업로드 | 필수 항목 확인 |
| 6️⃣ | 결과 확인 | 데이터 조회에서 확인 |

---

**작성일:** 2024-12-13  
**대상:** 중학생 이상  
**난이도:** ⭐⭐☆☆☆ (쉬움)
