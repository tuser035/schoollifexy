# ë™í™”ì±…(ìŠ¤í† ë¦¬ë¶) ì‹œìŠ¤í…œ ê°œë°œ ë¬¸ì„œ

> **ì‘ì„±ì¼**: 2025-12-19  
> **ëª©ì **: ì¤‘í•™ìƒ ë°ì´í„°ë² ì´ìŠ¤ ë™ì•„ë¦¬ í™œë™ ì‹¤ìŠµìš©  
> **ì‹œìŠ¤í…œ**: School Life - ì¸ë¬¸í•™ ìŠ¤í† ë¦¬ë¶ ê¸°ëŠ¥

---

## ğŸ“š ëª©ì°¨

1. [ì‹œìŠ¤í…œ ê°œìš”](#1-ì‹œìŠ¤í…œ-ê°œìš”)
2. [ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„](#2-ë°ì´í„°ë² ì´ìŠ¤-ì„¤ê³„)
3. [RPC í•¨ìˆ˜ ì„¤ëª…](#3-rpc-í•¨ìˆ˜-ì„¤ëª…)
4. [ê´€ë¦¬ì ê¸°ëŠ¥ (ë™í™”ì±… ê´€ë¦¬)](#4-ê´€ë¦¬ì-ê¸°ëŠ¥-ë™í™”ì±…-ê´€ë¦¬)
5. [í•™ìƒ ê¸°ëŠ¥ (ì¸ë¬¸í•™ì„œì )](#5-í•™ìƒ-ê¸°ëŠ¥-ì¸ë¬¸í•™ì„œì )
6. [UI ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°](#6-ui-ì»´í¬ë„ŒíŠ¸-êµ¬ì¡°)
7. [ì‹¤ìŠµ ê°€ì´ë“œ](#7-ì‹¤ìŠµ-ê°€ì´ë“œ)

---

## 1. ì‹œìŠ¤í…œ ê°œìš”

### 1.1 ê¸°ëŠ¥ ì†Œê°œ

ì´ ì‹œìŠ¤í…œì€ í•™ìƒë“¤ì´ ì¸ë¬¸í•™ ë™í™”ì±…ì„ ì½ê³ , ë…ì„œ ì§„í–‰ ìƒí™©ì„ ì¶”ì í•˜ë©°, ê°ìƒë¬¸ì„ ì‘ì„±í•  ìˆ˜ ìˆëŠ” ë””ì§€í„¸ ë„ì„œê´€ì…ë‹ˆë‹¤.

#### ê´€ë¦¬ì ê¸°ëŠ¥ (ë™í™”ì±… ë©”ë‰´)
- ë™í™”ì±… ìƒì„±, ìˆ˜ì •, ì‚­ì œ
- í‘œì§€ ì´ë¯¸ì§€ ë° ë³¸ë¬¸ í˜ì´ì§€ ì—…ë¡œë“œ
- CSV ì¼ê´„ ì—…ë¡œë“œ ê¸°ëŠ¥
- ë°œí–‰/ë¯¸ë°œí–‰ ìƒíƒœ ê´€ë¦¬
- ë¯¸ë¦¬ë³´ê¸° ë° TTS(ìŒì„± ì½ê¸°) í…ŒìŠ¤íŠ¸

#### í•™ìƒ ê¸°ëŠ¥ (ì¸ë¬¸í•™ì„œì  ë©”ë‰´)
- ì‹œë¦¬ì¦ˆë³„ ì±… ëª©ë¡ ì¡°íšŒ
- í˜ì´ì§€ë³„ ì½ê¸° (ì´ë¯¸ì§€ + í…ìŠ¤íŠ¸)
- TTS(ìŒì„± ì½ê¸°) ê¸°ëŠ¥
- ì½ê¸° ì§„í–‰ë¥  ìë™ ì €ì¥
- í˜ì´ì§€ ë¶ë§ˆí¬
- ê°ìƒë¬¸ ì‘ì„± ë° ê³µê°œ ì„¤ì •
- ë‹¤ë¥¸ í•™ìƒ ê°ìƒë¬¸ ë³´ê¸°

### 1.2 ê¸°ìˆ  ìŠ¤íƒ

| ì˜ì—­ | ê¸°ìˆ  |
|------|------|
| í”„ë¡ íŠ¸ì—”ë“œ | React 18, TypeScript, Tailwind CSS |
| UI ë¼ì´ë¸ŒëŸ¬ë¦¬ | shadcn/ui (Radix UI ê¸°ë°˜) |
| ë°±ì—”ë“œ | Supabase (PostgreSQL) |
| ìƒíƒœê´€ë¦¬ | React useState, useEffect |
| ë°ì´í„° í†µì‹  | Supabase JavaScript SDK |

---

## 2. ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„

### 2.1 ER ë‹¤ì´ì–´ê·¸ë¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   storybooks    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â”‚
â”‚ id (PK)         â”‚                  â”‚
â”‚ book_number     â”‚                  â”‚
â”‚ title           â”‚                  â”‚
â”‚ subtitle        â”‚                  â”‚
â”‚ cover_image_url â”‚                  â”‚
â”‚ description     â”‚                  â”‚
â”‚ page_count      â”‚                  â”‚
â”‚ is_published    â”‚                  â”‚
â”‚ created_at      â”‚                  â”‚
â”‚ updated_at      â”‚                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
        â”‚                            â”‚
        â”‚ 1:N                        â”‚ 1:N
        â–¼                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚ storybook_pages â”‚                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â”‚
â”‚ id (PK)         â”‚                  â”‚
â”‚ book_id (FK)    â”‚                  â”‚
â”‚ page_number     â”‚                  â”‚
â”‚ image_url       â”‚                  â”‚
â”‚ text_content    â”‚                  â”‚
â”‚ created_at      â”‚                  â”‚
â”‚ updated_at      â”‚                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
                                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚ storybook_reading_history â”‚ â—„â”€â”€â”€â”€â”€â”€â”˜
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”‚
â”‚ id (PK)                 â”‚          â”‚
â”‚ student_id (FK)         â”‚          â”‚
â”‚ book_id (FK)            â”‚          â”‚
â”‚ last_page               â”‚          â”‚
â”‚ is_completed            â”‚          â”‚
â”‚ started_at              â”‚          â”‚
â”‚ completed_at            â”‚          â”‚
â”‚ updated_at              â”‚          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
                                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚   storybook_reviews     â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”‚
â”‚ id (PK)                 â”‚          â”‚
â”‚ book_id (FK)            â”‚          â”‚
â”‚ student_id              â”‚          â”‚
â”‚ content                 â”‚          â”‚
â”‚ rating                  â”‚          â”‚
â”‚ is_public               â”‚          â”‚
â”‚ created_at              â”‚          â”‚
â”‚ updated_at              â”‚          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
                                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚ storybook_page_bookmarks    â”‚ â—„â”€â”€â”€â”€â”˜
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)                     â”‚
â”‚ student_id                  â”‚
â”‚ book_id (FK)                â”‚
â”‚ page_number                 â”‚
â”‚ created_at                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 í…Œì´ë¸” ìƒì„¸ ì„¤ëª…

#### 2.2.1 storybooks (ë™í™”ì±… ê¸°ë³¸ ì •ë³´)

| ì»¬ëŸ¼ëª… | ë°ì´í„° íƒ€ì… | NULL í—ˆìš© | ê¸°ë³¸ê°’ | ì„¤ëª… |
|--------|------------|-----------|--------|------|
| id | uuid | NO | gen_random_uuid() | ê³ ìœ  ì‹ë³„ì (ê¸°ë³¸í‚¤) |
| book_number | integer | NO | - | ì±… ì¼ë ¨ë²ˆí˜¸ (ì‹œë¦¬ì¦ˆ êµ¬ë¶„ìš©) |
| title | text | NO | - | ì±… ì œëª© |
| subtitle | text | YES | - | ë¶€ì œëª© |
| cover_image_url | text | YES | - | í‘œì§€ ì´ë¯¸ì§€ URL |
| description | text | YES | - | ì±… ì„¤ëª…/ì†Œê°œê¸€ |
| page_count | integer | YES | 0 | ì´ í˜ì´ì§€ ìˆ˜ |
| is_published | boolean | YES | false | ë°œí–‰ ì—¬ë¶€ |
| created_at | timestamptz | NO | now() | ìƒì„± ì‹œê° |
| updated_at | timestamptz | NO | now() | ìˆ˜ì • ì‹œê° |

**ì‹¤ìŠµ í¬ì¸íŠ¸**: 
- `book_number`ëŠ” ì‹œë¦¬ì¦ˆë¥¼ êµ¬ë¶„í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤ (1-5: ì§€í˜œì˜ ê°•, 6-10: ëª…ì‹¬ë³´ê° ë“±)
- `is_published`ê°€ trueì¸ ì±…ë§Œ í•™ìƒì—ê²Œ í‘œì‹œë©ë‹ˆë‹¤

#### 2.2.2 storybook_pages (ë™í™”ì±… í˜ì´ì§€)

| ì»¬ëŸ¼ëª… | ë°ì´í„° íƒ€ì… | NULL í—ˆìš© | ê¸°ë³¸ê°’ | ì„¤ëª… |
|--------|------------|-----------|--------|------|
| id | uuid | NO | gen_random_uuid() | ê³ ìœ  ì‹ë³„ì |
| book_id | uuid | NO | - | ë™í™”ì±… ID (ì™¸ë˜í‚¤) |
| page_number | integer | NO | - | í˜ì´ì§€ ë²ˆí˜¸ |
| image_url | text | YES | - | í˜ì´ì§€ ì‚½í™” URL |
| text_content | text | YES | - | í˜ì´ì§€ ë³¸ë¬¸ (ë§ˆí¬ë‹¤ìš´) |
| created_at | timestamptz | NO | now() | ìƒì„± ì‹œê° |
| updated_at | timestamptz | NO | now() | ìˆ˜ì • ì‹œê° |

**ì‹¤ìŠµ í¬ì¸íŠ¸**:
- í•˜ë‚˜ì˜ ì±…ì— ì—¬ëŸ¬ í˜ì´ì§€ê°€ ì—°ê²°ë˜ëŠ” **1:N ê´€ê³„**ì…ë‹ˆë‹¤
- `UNIQUE(book_id, page_number)` ì œì•½ìœ¼ë¡œ ì¤‘ë³µ ë°©ì§€

#### 2.2.3 storybook_reading_history (ì½ê¸° ê¸°ë¡)

| ì»¬ëŸ¼ëª… | ë°ì´í„° íƒ€ì… | NULL í—ˆìš© | ê¸°ë³¸ê°’ | ì„¤ëª… |
|--------|------------|-----------|--------|------|
| id | uuid | NO | gen_random_uuid() | ê³ ìœ  ì‹ë³„ì |
| student_id | text | NO | - | í•™ìƒ ID |
| book_id | uuid | NO | - | ë™í™”ì±… ID (ì™¸ë˜í‚¤) |
| last_page | integer | YES | 1 | ë§ˆì§€ë§‰ ì½ì€ í˜ì´ì§€ |
| is_completed | boolean | YES | false | ì™„ë… ì—¬ë¶€ |
| started_at | timestamptz | NO | now() | ì½ê¸° ì‹œì‘ ì‹œê° |
| completed_at | timestamptz | YES | - | ì™„ë… ì‹œê° |
| updated_at | timestamptz | NO | now() | ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸ |

**ì‹¤ìŠµ í¬ì¸íŠ¸**:
- í•™ìƒê³¼ ì±…ì˜ **ë‹¤:ë‹¤ ê´€ê³„**ë¥¼ ì¤‘ê°„ í…Œì´ë¸”ë¡œ êµ¬í˜„
- `UNIQUE(student_id, book_id)`ë¡œ í•œ í•™ìƒë‹¹ ì±…ë³„ë¡œ í•˜ë‚˜ì˜ ê¸°ë¡ë§Œ ìœ ì§€

#### 2.2.4 storybook_reviews (ê°ìƒë¬¸)

| ì»¬ëŸ¼ëª… | ë°ì´í„° íƒ€ì… | NULL í—ˆìš© | ê¸°ë³¸ê°’ | ì„¤ëª… |
|--------|------------|-----------|--------|------|
| id | uuid | NO | gen_random_uuid() | ê³ ìœ  ì‹ë³„ì |
| book_id | uuid | NO | - | ë™í™”ì±… ID (ì™¸ë˜í‚¤) |
| student_id | text | NO | - | í•™ìƒ ID |
| content | text | NO | - | ê°ìƒë¬¸ ë‚´ìš© |
| rating | integer | YES | - | ë³„ì  (1-5) |
| is_public | boolean | YES | false | ê³µê°œ ì—¬ë¶€ |
| created_at | timestamptz | NO | now() | ì‘ì„± ì‹œê° |
| updated_at | timestamptz | NO | now() | ìˆ˜ì • ì‹œê° |

#### 2.2.5 storybook_page_bookmarks (í˜ì´ì§€ ë¶ë§ˆí¬)

| ì»¬ëŸ¼ëª… | ë°ì´í„° íƒ€ì… | NULL í—ˆìš© | ê¸°ë³¸ê°’ | ì„¤ëª… |
|--------|------------|-----------|--------|------|
| id | uuid | NO | gen_random_uuid() | ê³ ìœ  ì‹ë³„ì |
| student_id | text | NO | - | í•™ìƒ ID |
| book_id | uuid | NO | - | ë™í™”ì±… ID (ì™¸ë˜í‚¤) |
| page_number | integer | NO | - | ë¶ë§ˆí¬í•œ í˜ì´ì§€ ë²ˆí˜¸ |
| created_at | timestamptz | NO | now() | ìƒì„± ì‹œê° |

### 2.3 í…Œì´ë¸” ìƒì„± SQL

```sql
-- 1. ë™í™”ì±… ê¸°ë³¸ ì •ë³´ í…Œì´ë¸”
CREATE TABLE public.storybooks (
  id UUID NOT NULL DEFAULT gen_random_uuid() PRIMARY KEY,
  book_number INTEGER NOT NULL UNIQUE,
  title TEXT NOT NULL,
  subtitle TEXT,
  cover_image_url TEXT,
  description TEXT,
  page_count INTEGER DEFAULT 0,
  is_published BOOLEAN DEFAULT false,
  created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(),
  updated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now()
);

-- 2. ë™í™”ì±… í˜ì´ì§€ í…Œì´ë¸”
CREATE TABLE public.storybook_pages (
  id UUID NOT NULL DEFAULT gen_random_uuid() PRIMARY KEY,
  book_id UUID NOT NULL REFERENCES storybooks(id) ON DELETE CASCADE,
  page_number INTEGER NOT NULL,
  image_url TEXT,
  text_content TEXT,
  created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(),
  updated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(),
  UNIQUE(book_id, page_number)
);

-- 3. ì½ê¸° ê¸°ë¡ í…Œì´ë¸”
CREATE TABLE public.storybook_reading_history (
  id UUID NOT NULL DEFAULT gen_random_uuid() PRIMARY KEY,
  student_id TEXT NOT NULL,
  book_id UUID NOT NULL REFERENCES storybooks(id) ON DELETE CASCADE,
  last_page INTEGER DEFAULT 1,
  is_completed BOOLEAN DEFAULT false,
  started_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(),
  completed_at TIMESTAMP WITH TIME ZONE,
  updated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(),
  UNIQUE(student_id, book_id)
);

-- 4. ê°ìƒë¬¸ í…Œì´ë¸”
CREATE TABLE public.storybook_reviews (
  id UUID NOT NULL DEFAULT gen_random_uuid() PRIMARY KEY,
  book_id UUID NOT NULL REFERENCES storybooks(id) ON DELETE CASCADE,
  student_id TEXT NOT NULL,
  content TEXT NOT NULL,
  rating INTEGER CHECK (rating >= 1 AND rating <= 5),
  is_public BOOLEAN DEFAULT false,
  created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(),
  updated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(),
  UNIQUE(student_id, book_id)
);

-- 5. í˜ì´ì§€ ë¶ë§ˆí¬ í…Œì´ë¸”
CREATE TABLE public.storybook_page_bookmarks (
  id UUID NOT NULL DEFAULT gen_random_uuid() PRIMARY KEY,
  student_id TEXT NOT NULL,
  book_id UUID NOT NULL REFERENCES storybooks(id) ON DELETE CASCADE,
  page_number INTEGER NOT NULL,
  created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(),
  UNIQUE(student_id, book_id, page_number)
);

-- ì¸ë±ìŠ¤ ìƒì„± (ì¡°íšŒ ì„±ëŠ¥ í–¥ìƒ)
CREATE INDEX idx_storybook_pages_book_id ON storybook_pages(book_id);
CREATE INDEX idx_reading_history_student ON storybook_reading_history(student_id);
CREATE INDEX idx_reviews_book_id ON storybook_reviews(book_id);
CREATE INDEX idx_bookmarks_student ON storybook_page_bookmarks(student_id);
```

---

## 3. RPC í•¨ìˆ˜ ì„¤ëª…

Supabaseì—ì„œëŠ” ë³µì¡í•œ ì¿¼ë¦¬ë‚˜ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ **RPC(Remote Procedure Call) í•¨ìˆ˜**ë¡œ êµ¬í˜„í•©ë‹ˆë‹¤.

### 3.1 ê´€ë¦¬ììš© RPC í•¨ìˆ˜

#### admin_get_storybooks
```sql
-- ê´€ë¦¬ìê°€ ëª¨ë“  ë™í™”ì±… ëª©ë¡ ì¡°íšŒ
CREATE OR REPLACE FUNCTION admin_get_storybooks(admin_id_input UUID)
RETURNS TABLE (
  id UUID,
  book_number INTEGER,
  title TEXT,
  subtitle TEXT,
  cover_image_url TEXT,
  description TEXT,
  page_count INTEGER,
  is_published BOOLEAN,
  created_at TIMESTAMPTZ
)
```

**ì‚¬ìš© ì˜ˆì‹œ (JavaScript)**:
```javascript
const { data, error } = await supabase.rpc('admin_get_storybooks', {
  admin_id_input: adminId
});
```

#### admin_insert_storybook
```sql
-- ìƒˆ ë™í™”ì±… ìƒì„±
CREATE OR REPLACE FUNCTION admin_insert_storybook(
  admin_id_input UUID,
  book_number_input INTEGER,
  title_input TEXT,
  description_input TEXT DEFAULT NULL
)
RETURNS UUID  -- ìƒì„±ëœ ì±…ì˜ ID ë°˜í™˜
```

#### admin_upsert_storybook_page
```sql
-- í˜ì´ì§€ ì¶”ê°€/ìˆ˜ì • (UPSERT íŒ¨í„´)
CREATE OR REPLACE FUNCTION admin_upsert_storybook_page(
  admin_id_input UUID,
  book_id_input UUID,
  page_number_input INTEGER,
  image_url_input TEXT DEFAULT NULL,
  text_content_input TEXT DEFAULT NULL
)
RETURNS UUID
```

**ì‹¤ìŠµ í¬ì¸íŠ¸**: UPSERTëŠ” INSERT + UPDATEì˜ í•©ì„±ì–´ë¡œ, ë°ì´í„°ê°€ ìˆìœ¼ë©´ ìˆ˜ì •í•˜ê³  ì—†ìœ¼ë©´ ì¶”ê°€í•©ë‹ˆë‹¤.

### 3.2 í•™ìƒìš© RPC í•¨ìˆ˜

#### student_get_storybooks
```sql
-- í•™ìƒì´ ë°œí–‰ëœ ì±… ëª©ë¡ + ì½ê¸° ì§„í–‰ë¥  ì¡°íšŒ
CREATE OR REPLACE FUNCTION student_get_storybooks(student_id_input TEXT)
RETURNS TABLE (
  id UUID,
  book_number INTEGER,
  title TEXT,
  cover_image_url TEXT,
  description TEXT,
  page_count INTEGER,
  last_page INTEGER,      -- ë‚´ê°€ ì½ì€ ë§ˆì§€ë§‰ í˜ì´ì§€
  is_completed BOOLEAN    -- ì™„ë… ì—¬ë¶€
)
```

#### student_update_reading_progress
```sql
-- ì½ê¸° ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
CREATE OR REPLACE FUNCTION student_update_reading_progress(
  student_id_input TEXT,
  book_id_input UUID,
  last_page_input INTEGER,
  is_completed_input BOOLEAN DEFAULT FALSE
)
RETURNS BOOLEAN
```

#### student_save_review
```sql
-- ê°ìƒë¬¸ ì €ì¥
CREATE OR REPLACE FUNCTION student_save_review(
  student_id_input TEXT,
  book_id_input UUID,
  content_input TEXT,
  rating_input INTEGER
)
RETURNS UUID
```

#### get_public_reviews
```sql
-- ê³µê°œëœ ê°ìƒë¬¸ ëª©ë¡ ì¡°íšŒ
CREATE OR REPLACE FUNCTION get_public_reviews(book_id_input UUID)
RETURNS TABLE (
  id UUID,
  student_id TEXT,
  student_name TEXT,
  content TEXT,
  rating INTEGER,
  created_at TIMESTAMPTZ
)
```

---

## 4. ê´€ë¦¬ì ê¸°ëŠ¥ (ë™í™”ì±… ê´€ë¦¬)

### 4.1 ì»´í¬ë„ŒíŠ¸ íŒŒì¼ ìœ„ì¹˜

```
src/components/admin/StorybookManager.tsx
```

### 4.2 ì£¼ìš” ê¸°ëŠ¥ íë¦„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ë™í™”ì±… ê´€ë¦¬ í™”ë©´                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [+ ìƒˆ ë™í™”ì±…]  [CSV ì—…ë¡œë“œ]  [ìƒˆë¡œê³ ì¹¨]                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ #1 â”‚ ì§€í˜œì˜ ê°• 1í™” â”‚ 5í˜ì´ì§€ â”‚ [ë°œí–‰ì¤‘] â”‚ [í¸ì§‘] â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ #2 â”‚ ì§€í˜œì˜ ê°• 2í™” â”‚ 6í˜ì´ì§€ â”‚ [ë¯¸ë°œí–‰] â”‚ [í¸ì§‘] â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼ [í¸ì§‘] í´ë¦­
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ì±… í¸ì§‘ ë‹¤ì´ì–¼ë¡œê·¸                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [í‘œì§€/ì„¤ëª…]  [ë³¸ë¬¸ í˜ì´ì§€]                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                â”‚  â”‚ ì„¤ëª…:                        â”‚   â”‚
â”‚  â”‚   [í‘œì§€ ì´ë¯¸ì§€] â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚                â”‚  â”‚ â”‚ ë§ˆí¬ë‹¤ìš´ ì…ë ¥ ì˜ì—­     â”‚   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  [ì´ë¯¸ì§€ ì—…ë¡œë“œ]      â”‚ [ì €ì¥]                       â”‚   â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.3 í•µì‹¬ ì½”ë“œ ë¶„ì„

#### ìƒíƒœ ê´€ë¦¬ (State)
```typescript
// ì±… ëª©ë¡
const [books, setBooks] = useState<Storybook[]>([]);
const [loading, setLoading] = useState(true);
const [selectedBook, setSelectedBook] = useState<Storybook | null>(null);

// í˜ì´ì§€ ë°ì´í„°
const [pages, setPages] = useState<StorybookPage[]>([]);
const [currentPageNumber, setCurrentPageNumber] = useState(1);
const [pageText, setPageText] = useState('');
const [pageImagePreview, setPageImagePreview] = useState<string | null>(null);
```

#### ë°ì´í„° ë¡œë“œ í•¨ìˆ˜
```typescript
const loadBooks = async () => {
  try {
    setLoading(true);
    const { data, error } = await supabase.rpc('admin_get_storybooks', {
      admin_id_input: adminId
    });

    if (error) throw error;
    setBooks(data || []);
  } catch (error) {
    console.error('Error loading books:', error);
    toast.error('ë™í™”ì±… ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');
  } finally {
    setLoading(false);
  }
};
```

#### ì±… ìƒì„± í•¨ìˆ˜
```typescript
const handleCreateBook = async () => {
  if (!newBookNumber || !newTitle) {
    toast.error('ì¼ë ¨ë²ˆí˜¸ì™€ ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”');
    return;
  }

  try {
    const { data, error } = await supabase.rpc('admin_insert_storybook', {
      admin_id_input: adminId,
      book_number_input: parseInt(newBookNumber),
      title_input: newTitle,
      description_input: newDescription || null
    });

    if (error) throw error;
    toast.success('ë™í™”ì±…ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤');
    loadBooks(); // ëª©ë¡ ìƒˆë¡œê³ ì¹¨
  } catch (error) {
    toast.error('ë™í™”ì±… ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');
  }
};
```

### 4.4 TTS (ìŒì„± ì½ê¸°) ê¸°ëŠ¥

```typescript
const handleTTS = (text: string) => {
  // ì´ë¯¸ ì½ê³  ìˆìœ¼ë©´ ì¤‘ì§€
  if (isSpeaking) {
    window.speechSynthesis.cancel();
    setIsSpeaking(false);
    return;
  }

  // ìƒˆ ìŒì„± ê°ì²´ ìƒì„±
  const utterance = new SpeechSynthesisUtterance(text);
  utterance.lang = 'ko-KR';        // í•œêµ­ì–´
  utterance.rate = speechRate;      // ì½ê¸° ì†ë„
  
  utterance.onend = () => setIsSpeaking(false);
  utterance.onerror = () => setIsSpeaking(false);
  
  window.speechSynthesis.speak(utterance);
  setIsSpeaking(true);
};
```

---

## 5. í•™ìƒ ê¸°ëŠ¥ (ì¸ë¬¸í•™ì„œì )

### 5.1 ì»´í¬ë„ŒíŠ¸ íŒŒì¼ ìœ„ì¹˜

```
src/components/student/StorybookLibrary.tsx
src/config/bookSeriesConfig.ts
```

### 5.2 ì‹œë¦¬ì¦ˆ ì„¤ì • êµ¬ì¡°

```typescript
// bookSeriesConfig.ts
export interface BookSeries {
  id: string;                           // ì‹œë¦¬ì¦ˆ ê³ ìœ  ID
  title: string;                        // ì‹œë¦¬ì¦ˆ ì œëª©
  subtitle: string;                     // ì‹œë¦¬ì¦ˆ ë¶€ì œ
  icon: keyof typeof AVAILABLE_ICONS;   // ì•„ì´ì½˜ ì´ë¦„
  bookNumberRange: { min: number; max: number };  // ì±… ë²ˆí˜¸ ë²”ìœ„
  theme: SeriesTheme;                   // í…Œë§ˆ ìŠ¤íƒ€ì¼
}

export const BOOK_SERIES: BookSeries[] = [
  {
    id: 'wisdom-river',
    title: 'ì´ì§€ì˜ì˜ ì§€í˜œì˜ ê°•',
    subtitle: 'ì² í•™ì  ì‚¬ê³ ë¥¼ í‚¤ìš°ëŠ” ì´ì•¼ê¸°',
    icon: 'BookOpen',
    bookNumberRange: { min: 1, max: 5 },  // 1~5ë²ˆ ì±…
    theme: { /* ì—ë©”ë„ë“œ í…Œë§ˆ */ }
  },
  {
    id: 'myungsim',
    title: 'ëª…ì‹¬ë³´ê°',
    subtitle: 'ë§ˆìŒì„ ë°íˆëŠ” ì˜› ì§€í˜œ',
    icon: 'BookMarked',
    bookNumberRange: { min: 6, max: 10 }, // 6~10ë²ˆ ì±…
    theme: { /* ì•°ë²„ í…Œë§ˆ */ }
  },
  // ... ë” ë§ì€ ì‹œë¦¬ì¦ˆ
];
```

### 5.3 ì½ê¸° í™”ë©´ UI êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [X] ì±… ì œëª©                            [ğŸ”Š] [âš™ï¸] [â›¶]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                   â”‚   â”‚
â”‚  â”‚                    [ì‚½í™” ì´ë¯¸ì§€]                  â”‚   â”‚
â”‚  â”‚                                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ **ì†Œì œëª©**                                        â”‚   â”‚
â”‚  â”‚                                                   â”‚   â”‚
â”‚  â”‚ ë³¸ë¬¸ ë‚´ìš©ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.                    â”‚   â”‚
â”‚  â”‚ ë§ˆí¬ë‹¤ìš´ í˜•ì‹ì„ ì§€ì›í•˜ë©°,                         â”‚   â”‚
â”‚  â”‚ TTSë¡œ ì½ì„ ë•Œ í˜„ì¬ ë¬¸ì¥ì´ í•˜ì´ë¼ì´íŠ¸ë©ë‹ˆë‹¤.       â”‚   â”‚
â”‚  â”‚                                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [â—€ ì´ì „]       â— â—‹ â—‹ â—‹ â—‹ (í˜ì´ì§€ í‘œì‹œ)      [ë‹¤ìŒ â–¶]  â”‚
â”‚                                                         â”‚
â”‚  [â¤ï¸ ë¶ë§ˆí¬]                              [âœï¸ ê°ìƒë¬¸]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.4 í•µì‹¬ ê¸°ëŠ¥ ì½”ë“œ

#### ì±… ì—´ê¸° ë° í˜ì´ì§€ ë¡œë“œ
```typescript
const openBook = async (book: Storybook) => {
  try {
    setSelectedBook(book);
    setCurrentPage(1);

    // í˜ì´ì§€ ë°ì´í„° ë¡œë“œ
    const { data, error } = await supabase.rpc('student_get_storybook_pages', {
      student_id_input: studentId,
      book_id_input: book.id
    });

    if (error) throw error;
    setPages(data || []);
    
    // ë¶ë§ˆí¬ ë¡œë“œ
    loadBookmarks(book.id);
    
    setIsReaderOpen(true);
  } catch (error) {
    toast.error('ì±…ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');
  }
};
```

#### ì½ê¸° ì§„í–‰ë¥  ì €ì¥
```typescript
const saveProgress = async () => {
  if (!selectedBook) return;
  
  const isCompleted = currentPage >= pages.length;
  
  try {
    await supabase.rpc('student_update_reading_progress', {
      student_id_input: studentId,
      book_id_input: selectedBook.id,
      last_page_input: currentPage,
      is_completed_input: isCompleted
    });
    
    // ì™„ë… ì‹œ ì¶•í•˜ ì• ë‹ˆë©”ì´ì…˜
    if (isCompleted && !selectedBook.is_completed) {
      setShowCelebration(true);
    }
  } catch (error) {
    console.error('Error saving progress:', error);
  }
};
```

#### ë¬¸ì¥ í•˜ì´ë¼ì´íŠ¸ ë Œë”ë§
```typescript
const renderHighlightedText = useCallback((text: string) => {
  if (!isSpeaking || currentSentenceIndex < 0) {
    return text;
  }

  const sentences = splitIntoSentences(text);
  return (
    <>
      {sentences.map((sentence, idx) => (
        <span
          key={idx}
          className={`transition-all duration-300 ${
            idx === currentSentenceIndex
              ? 'bg-amber-100 text-amber-900 rounded px-0.5'  // í˜„ì¬ ì½ëŠ” ë¬¸ì¥
              : ''
          }`}
        >
          {sentence}{idx < sentences.length - 1 ? ' ' : ''}
        </span>
      ))}
    </>
  );
}, [isSpeaking, currentSentenceIndex]);
```

---

## 6. UI ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°

### 6.1 ì‚¬ìš©ëœ shadcn/ui ì»´í¬ë„ŒíŠ¸

| ì»´í¬ë„ŒíŠ¸ | ìš©ë„ |
|----------|------|
| `Dialog` | ëª¨ë‹¬ íŒì—… (ì±… í¸ì§‘, ë¯¸ë¦¬ë³´ê¸°) |
| `Card` | ì±… ëª©ë¡ ì¹´ë“œ |
| `Button` | ëª¨ë“  ë²„íŠ¼ |
| `Input` | í…ìŠ¤íŠ¸ ì…ë ¥ |
| `Textarea` | ê¸´ í…ìŠ¤íŠ¸ ì…ë ¥ (ë³¸ë¬¸, ê°ìƒë¬¸) |
| `Badge` | ìƒíƒœ í‘œì‹œ (ë°œí–‰ë¨, ì™„ë… ë“±) |
| `Tabs` | íƒ­ ì¸í„°í˜ì´ìŠ¤ |
| `Accordion` | ì‹œë¦¬ì¦ˆë³„ ì ‘ê¸°/í¼ì¹˜ê¸° |
| `Switch` | ON/OFF í† ê¸€ |
| `Slider` | ì½ê¸° ì†ë„ ì¡°ì ˆ |
| `Progress` | ì§„í–‰ë¥  í‘œì‹œ |

### 6.2 ë°˜ì‘í˜• ë””ìì¸

```typescript
// ëª¨ë°”ì¼/ë°ìŠ¤í¬í†± ë¶„ê¸° ì˜ˆì‹œ
<div className="hidden md:block">
  {/* ë°ìŠ¤í¬í†±ì—ì„œë§Œ í‘œì‹œ */}
</div>

<div className="md:hidden">
  {/* ëª¨ë°”ì¼ì—ì„œë§Œ í‘œì‹œ */}
</div>

// ê·¸ë¦¬ë“œ ë°˜ì‘í˜•
<div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
  {/* ëª¨ë°”ì¼: 1ì—´, íƒœë¸”ë¦¿: 2ì—´, ë°ìŠ¤í¬í†±: 3ì—´ */}
</div>
```

### 6.3 ì• ë‹ˆë©”ì´ì…˜ (í˜ì´ì§€ ë„˜ê¹€)

```css
/* í˜ì´ì§€ ì „í™˜ ì• ë‹ˆë©”ì´ì…˜ */
@keyframes page-curl {
  0% { transform: rotateY(0deg); }
  100% { transform: rotateY(-90deg); }
}

.page-transition-exit {
  animation: page-curl 0.35s ease-in-out;
  transform-origin: left center;
}

.page-transition-enter {
  animation: page-curl 0.35s ease-in-out reverse;
  transform-origin: left center;
}
```

---

## 7. ì‹¤ìŠµ ê°€ì´ë“œ

### 7.1 í™˜ê²½ ì„¤ì •

1. **Supabase í”„ë¡œì íŠ¸ ìƒì„±**
   - https://supabase.com ì—ì„œ ìƒˆ í”„ë¡œì íŠ¸ ìƒì„±
   - í”„ë¡œì íŠ¸ URLê³¼ anon key ë³µì‚¬

2. **í…Œì´ë¸” ìƒì„±**
   - SQL Editorì—ì„œ 2.3ì ˆì˜ SQL ì‹¤í–‰

3. **RPC í•¨ìˆ˜ ìƒì„±**
   - 3ì¥ì˜ í•¨ìˆ˜ë“¤ì„ SQL Editorì—ì„œ ìƒì„±

### 7.2 ê¸°ë³¸ ì‹¤ìŠµ ê³¼ì œ

#### ê³¼ì œ 1: ë°ì´í„° ì¡°íšŒ
```sql
-- ëª¨ë“  ë™í™”ì±… ì¡°íšŒ
SELECT * FROM storybooks ORDER BY book_number;

-- íŠ¹ì • ì±…ì˜ í˜ì´ì§€ ì¡°íšŒ
SELECT * FROM storybook_pages 
WHERE book_id = 'ì±…ID' 
ORDER BY page_number;
```

#### ê³¼ì œ 2: ë°ì´í„° ì…ë ¥
```sql
-- ìƒˆ ë™í™”ì±… ì¶”ê°€
INSERT INTO storybooks (book_number, title, description)
VALUES (1, 'ì²« ë²ˆì§¸ ì´ì•¼ê¸°', 'ì´ê²ƒì€ í…ŒìŠ¤íŠ¸ ì±…ì…ë‹ˆë‹¤.');

-- í˜ì´ì§€ ì¶”ê°€
INSERT INTO storybook_pages (book_id, page_number, text_content)
VALUES ('ë°©ê¸ˆ ìƒì„±í•œ ì±…ID', 1, '## 1ì¥\n\nì˜›ë‚  ì˜›ì ì—...');
```

#### ê³¼ì œ 3: ë°ì´í„° ìˆ˜ì •
```sql
-- ì±… ë°œí–‰í•˜ê¸°
UPDATE storybooks SET is_published = true WHERE id = 'ì±…ID';

-- í˜ì´ì§€ ë‚´ìš© ìˆ˜ì •
UPDATE storybook_pages 
SET text_content = 'ìˆ˜ì •ëœ ë‚´ìš©' 
WHERE book_id = 'ì±…ID' AND page_number = 1;
```

#### ê³¼ì œ 4: ì¡°ì¸ ì¿¼ë¦¬
```sql
-- ì±…ê³¼ í˜ì´ì§€ ìˆ˜ í•¨ê»˜ ì¡°íšŒ
SELECT 
  s.title,
  s.book_number,
  COUNT(p.id) as actual_page_count
FROM storybooks s
LEFT JOIN storybook_pages p ON s.id = p.book_id
GROUP BY s.id
ORDER BY s.book_number;
```

### 7.3 ì‹¬í™” ì‹¤ìŠµ ê³¼ì œ

#### ê³¼ì œ 5: ì½ê¸° í†µê³„ ë¶„ì„
```sql
-- ê°€ì¥ ë§ì´ ì½íŒ ì±… TOP 5
SELECT 
  s.title,
  COUNT(rh.id) as reader_count,
  SUM(CASE WHEN rh.is_completed THEN 1 ELSE 0 END) as completed_count
FROM storybooks s
LEFT JOIN storybook_reading_history rh ON s.id = rh.book_id
GROUP BY s.id
ORDER BY reader_count DESC
LIMIT 5;
```

#### ê³¼ì œ 6: ê°ìƒë¬¸ í†µê³„
```sql
-- í‰ê·  ë³„ì ì´ ë†’ì€ ì±… ì¡°íšŒ
SELECT 
  s.title,
  ROUND(AVG(r.rating), 1) as avg_rating,
  COUNT(r.id) as review_count
FROM storybooks s
LEFT JOIN storybook_reviews r ON s.id = r.book_id
GROUP BY s.id
HAVING COUNT(r.id) > 0
ORDER BY avg_rating DESC;
```

### 7.4 í”„ë¡ íŠ¸ì—”ë“œ ì‹¤ìŠµ ê³¼ì œ

1. **ì±… ëª©ë¡ í‘œì‹œ**: `supabase.rpc()` í˜¸ì¶œí•˜ì—¬ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
2. **ìƒíƒœ ê´€ë¦¬**: `useState`ë¡œ ë¡œë”©/ì—ëŸ¬/ë°ì´í„° ìƒíƒœ ê´€ë¦¬
3. **ì¡°ê±´ë¶€ ë Œë”ë§**: ë¡œë”© ì¤‘, ë°ì´í„° ì—†ìŒ, ì—ëŸ¬ ìƒíƒœ ì²˜ë¦¬
4. **ì´ë²¤íŠ¸ í•¸ë“¤ë§**: ë²„íŠ¼ í´ë¦­ìœ¼ë¡œ ë°ì´í„° ìˆ˜ì •

---

## ğŸ“ ì°¸ê³  ìë£Œ

- [Supabase ê³µì‹ ë¬¸ì„œ](https://supabase.com/docs)
- [React ê³µì‹ ë¬¸ì„œ](https://react.dev)
- [Tailwind CSS ë¬¸ì„œ](https://tailwindcss.com/docs)
- [shadcn/ui ì»´í¬ë„ŒíŠ¸](https://ui.shadcn.com)

---

> **ë¬¸ì„œ ë**  
> ì‘ì„±: School Life ê°œë°œíŒ€
